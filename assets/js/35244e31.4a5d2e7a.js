"use strict";(self.webpackChunkyaklang=self.webpackChunkyaklang||[]).push([[815],{3905:(e,t,n)=>{n.d(t,{Zo:()=>o,kt:()=>d});var p=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);t&&(p=p.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,p)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,p,i=function(e,t){if(null==e)return{};var n,p,i={},r=Object.keys(e);for(p=0;p<r.length;p++)n=r[p],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(p=0;p<r.length;p++)n=r[p],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=p.createContext({}),k=function(e){var t=p.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},o=function(e){var t=k(e.components);return p.createElement(c.Provider,{value:t},e.children)},s="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return p.createElement(p.Fragment,{},t)}},u=p.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,c=e.parentName,o=l(e,["components","mdxType","originalType","parentName"]),s=k(n),u=i,d=s["".concat(c,".").concat(u)]||s[u]||h[u]||r;return n?p.createElement(d,a(a({ref:t},o),{},{components:n})):p.createElement(d,a({ref:t},o))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,a=new Array(r);a[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[s]="string"==typeof e?e:i,a[1]=l;for(var k=2;k<r;k++)a[k]=n[k];return p.createElement.apply(null,a)}return p.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7905:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>a,default:()=>s,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var p=n(87462),i=(n(67294),n(3905));const r={sidebar_position:13},a="Thinkphp\u63d2\u4ef6\u4f7f\u7528",l={unversionedId:"DetectionPlug-in/Thinkphp",id:"DetectionPlug-in/Thinkphp",isDocsHomePage:!1,title:"Thinkphp\u63d2\u4ef6\u4f7f\u7528",description:"1 Thinkphp-5.0.22/5.1.29-RCE",source:"@site/wiki/DetectionPlug-in/Thinkphp.md",sourceDirName:"DetectionPlug-in",slug:"/DetectionPlug-in/Thinkphp",permalink:"/wiki/DetectionPlug-in/Thinkphp",tags:[],version:"current",sidebarPosition:13,frontMatter:{sidebar_position:13},sidebar:"teamSidebar",previous:{title:"Nginx\u63d2\u4ef6\u4f7f\u7528",permalink:"/wiki/DetectionPlug-in/Nginx"},next:{title:"Apache\u63d2\u4ef6\u4f7f\u7528",permalink:"/wiki/DetectionPlug-in/Apache"}},c=[{value:"1 Thinkphp-5.0.22/5.1.29-RCE",id:"1-thinkphp-50225129-rce",children:[]},{value:"2 ThinkPHP CNVD-2018-2494 \u6f0f\u6d1e\u68c0\u6d4b",id:"2-thinkphp-cnvd-2018-2494-\u6f0f\u6d1e\u68c0\u6d4b",children:[]},{value:"3 ThinkPHP5023 method rce \u6f0f\u6d1e",id:"3-thinkphp5023-method-rce-\u6f0f\u6d1e",children:[]},{value:"4 ThinkPHP_2.x~3.0 Beta\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b",id:"4-thinkphp_2x30-beta\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b",children:[]},{value:"5 ThinkPHP v6 file write \u6f0f\u6d1e",id:"5-thinkphp-v6-file-write-\u6f0f\u6d1e",children:[]},{value:"6 ThinkPHP-5.x/3.x/6.x-\u65e5\u5fd7\u6cc4\u9732-V0.2",id:"6-thinkphp-5x3x6x-\u65e5\u5fd7\u6cc4\u9732-v02",children:[]},{value:"7 ThinkPHP5 controller rce \u6f0f\u6d1e",id:"7-thinkphp5-controller-rce-\u6f0f\u6d1e",children:[]},{value:"8 ThinkPHP_Lang_RCE",id:"8-thinkphp_lang_rce",children:[]},{value:"9 ThinkPHP RCE \u88ab\u52a8\u626b\u63cf",id:"9-thinkphp-rce-\u88ab\u52a8\u626b\u63cf",children:[]}],k={toc:c},o="wrapper";function s(e){let{components:t,...r}=e;return(0,i.kt)(o,(0,p.Z)({},k,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"thinkphp\u63d2\u4ef6\u4f7f\u7528"},"Thinkphp\u63d2\u4ef6\u4f7f\u7528"),(0,i.kt)("h2",{id:"1-thinkphp-50225129-rce"},"1 Thinkphp-5.0.22/5.1.29-RCE"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"711ce43e-2bd8-4788-8c2a-2dee1b0279fc"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"vulhub\u6d4b\u8bd5\u7f51\u7ad9\u5730\u5740\u8f93\u5165\u5230\u8be5\u63d2\u4ef6\u626b\u63cf\u76ee\u6807\u680f\uff0c\u63d2\u4ef6\u9ed8\u8ba4\u7aef\u53e3\u4e3a8080\u5c31\u4e0d\u7528\u518d\u4fee\u6539\n\u63d2\u4ef6\u6210\u529f\u68c0\u6d4b\u5230\u8be5\u6f0f\u6d1e"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(21074).Z})),(0,i.kt)("p",null,"\u5e76\u4e14\u53ef\u4ee5\u4e00\u952egetshell"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(21258).Z})),(0,i.kt)("p",null,"\u8f93\u5165shell\u5730\u5740\u548c\u5bc6\u7801\u53ef\u4ee5\u76f4\u63a5\u94fe\u63a5"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(42580).Z})),(0,i.kt)("h2",{id:"2-thinkphp-cnvd-2018-2494-\u6f0f\u6d1e\u68c0\u6d4b"},"2 ThinkPHP CNVD-2018-2494 \u6f0f\u6d1e\u68c0\u6d4b"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"Yakit\u6b63\u5728\u52aa\u529b\u7f16\u5199~"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"\u6d4b\u8bd5\u7f51\u7ad9\uff1avulfocus\u9776\u573a\npayload\uff1a",(0,i.kt)("a",{parentName:"p",href:"http://xx.xx.x.xx:xxx/index.php?s=/Index/%5Cthink%5Capp/invokefunction&function=call_user_func_array&vars%5B0%5D=phpinfo&vars%5B1%5D%5B%5D=-1"},"http://xx.xx.x.xx:xxx/index.php?s=/Index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=-1")),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(88852).Z})),(0,i.kt)("h2",{id:"3-thinkphp5023-method-rce-\u6f0f\u6d1e"},"3 ThinkPHP5023 method rce \u6f0f\u6d1e"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"696fe1c8-8390-47b3-a0a2-185a69bb1cc8"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"\u76f4\u63a5\u5728\u63d2\u4ef6\u4e2d\u8f93\u5165\u5730\u5740\uff0b\u7aef\u53e3\u8fdb\u884c\u626b\u63cf\uff0c\u5f97\u51fa\u6d4b\u8bd5\u7ed3\u679c"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(54846).Z})),(0,i.kt)("h2",{id:"4-thinkphp_2x30-beta\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b"},"4 ThinkPHP_2.x~3.0 Beta\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"254be510-6b1d-4e7f-8a70-b2f26ebab5b6"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"\u8bbf\u95ee\u6f0f\u6d1e\u5730\u5740\u663e\u793a\uff1a"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(17268).Z})),(0,i.kt)("p",null,"\u76f4\u63a5\u8f93\u5165\u5730\u5740\u626b\u63cf\uff0c\u6210\u529f\u9a8c\u8bc1\u6f0f\u6d1e\u5b58\u5728"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(36200).Z})),(0,i.kt)("h2",{id:"5-thinkphp-v6-file-write-\u6f0f\u6d1e"},"5 ThinkPHP v6 file write \u6f0f\u6d1e"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"Yakit\u6b63\u5728\u52aa\u529b\u7f16\u5199~"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"\u6682\u65e0\u6848\u4f8b"),(0,i.kt)("h2",{id:"6-thinkphp-5x3x6x-\u65e5\u5fd7\u6cc4\u9732-v02"},"6 ThinkPHP-5.x/3.x/6.x-\u65e5\u5fd7\u6cc4\u9732-V0.2"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"b6844edb-9b90-4836-8959-74a74727a9b8"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"\u6d4b\u8bd5\u7f51\u7ad9\u5728\u63a5\u53e3/App/Runtime/Logs/Home/23_02_27.log\u4e0b\u5b58\u5728\u65e5\u5fd7\u6cc4\u6f0f"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(76013).Z})),(0,i.kt)("p",null,"\u63d2\u4ef6\u6210\u529f\u68c0\u6d4b\u51fa\u6765\u6f0f\u6d1e"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(43944).Z})),(0,i.kt)("h2",{id:"7-thinkphp5-controller-rce-\u6f0f\u6d1e"},"7 ThinkPHP5 controller rce \u6f0f\u6d1e"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"a020beed-7c49-4e5a-a0b3-5dbb01cf4356"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"\u5c06\u9776\u573aip\u548c\u7aef\u53e3\u586b\u5165\uff0c\u70b9\u51fb\u5f00\u59cb\u6267\u884c\n\u6210\u529f\u68c0\u6d4b\u51fa\u8be5\u6f0f\u6d1e"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(21315).Z})),(0,i.kt)("h2",{id:"8-thinkphp_lang_rce"},"8 ThinkPHP_Lang_RCE"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"3d771294-474c-4f41-b8ca-b9cf92028894"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"\u6682\u65e0\u6848\u4f8b"),(0,i.kt)("h2",{id:"9-thinkphp-rce-\u88ab\u52a8\u626b\u63cf"},"9 ThinkPHP RCE \u88ab\u52a8\u626b\u63cf"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,i.kt)("p",null,"09e1d6c4-4b4d-4a49-9b8c-ab45d31437dd"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,i.kt)("p",null,"Yakit\u5f00\u8d77\u88ab\u52a8\u626b\u63cf\u63d2\u4ef6\u53bb\u8bbf\u95ee\u9776\u573a\u73af\u5883\uff0c\u6210\u529f\u68c0\u6d4b\u51fa\u6f0f\u6d1e"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(66449).Z}),"\n",(0,i.kt)("img",{src:n(95317).Z})))}s.isMDXComponent=!0},21074:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-1-468261dad911e1e69bc56ae7d5f9b40a.png"},21315:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-10-150faf9978ca19ba6099a80fed1d0861.png"},66449:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-11-bd933062003d1749457c8c523b706023.png"},95317:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-12-e543165d5960f6d50136219568b524fb.png"},21258:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-2-675a5752781e9a90e0e121d8bfaff7a5.png"},42580:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-3-9b4c79428ca2a70f67855d2cf895ea81.png"},88852:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-4-080628716374f59e3d76bc131e2dd8b0.png"},54846:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-5-47f861c5d96b93ffe136fd9d4d8e48a7.png"},17268:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-6-31981cccceb7d5950e4b7ecb976db6e7.png"},36200:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-7-9b4a6a4fbfeec1b6c355648676a4b3c3.png"},76013:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-8-6a2220429a285b1ca63e79d1f8d845a9.png"},43944:(e,t,n)=>{n.d(t,{Z:()=>p});const p=n.p+"assets/images/Thinkphp-9-52e04431305baa33a05b288921e56949.png"}}]);