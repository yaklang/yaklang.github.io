"use strict";(self.webpackChunkyaklang=self.webpackChunkyaklang||[]).push([[3226],{15680:(n,e,a)=>{a.d(e,{xA:()=>c,yg:()=>u});var r=a(96540);function t(n,e,a){return e in n?Object.defineProperty(n,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[e]=a,n}function i(n,e){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.push.apply(a,r)}return a}function o(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){t(n,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))}))}return n}function s(n,e){if(null==n)return{};var a,r,t=function(n,e){if(null==n)return{};var a,r,t={},i=Object.keys(n);for(r=0;r<i.length;r++)a=i[r],e.indexOf(a)>=0||(t[a]=n[a]);return t}(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)a=i[r],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(n,a)&&(t[a]=n[a])}return t}var l=r.createContext({}),g=function(n){var e=r.useContext(l),a=e;return n&&(a="function"==typeof n?n(e):o(o({},e),n)),a},c=function(n){var e=g(n.components);return r.createElement(l.Provider,{value:e},n.children)},d="mdxType",m={inlineCode:"code",wrapper:function(n){var e=n.children;return r.createElement(r.Fragment,{},e)}},p=r.forwardRef((function(n,e){var a=n.components,t=n.mdxType,i=n.originalType,l=n.parentName,c=s(n,["components","mdxType","originalType","parentName"]),d=g(a),p=t,u=d["".concat(l,".").concat(p)]||d[p]||m[p]||i;return a?r.createElement(u,o(o({ref:e},c),{},{components:a})):r.createElement(u,o({ref:e},c))}));function u(n,e){var a=arguments,t=e&&e.mdxType;if("string"==typeof n||t){var i=a.length,o=new Array(i);o[0]=p;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=n,s[d]="string"==typeof n?n:t,o[1]=s;for(var g=2;g<i;g++)o[g]=a[g];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}p.displayName="MDXCreateElement"},38599:(n,e,a)=>{a.r(e),a.d(e,{contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=a(58168),t=(a(96540),a(15680));const i={sidebar_position:5},o="\u5b9e\u62181: \u626b\u7aef\u53e3/\u5b50\u57df\u540d+\u6307\u7eb9\u8bc6\u522b",s={unversionedId:"yakexamples/yak_misc",id:"yakexamples/yak_misc",isDocsHomePage:!1,title:"\u5b9e\u62181: \u626b\u7aef\u53e3/\u5b50\u57df\u540d+\u6307\u7eb9\u8bc6\u522b",description:"\u672c\u5c4a\u6211\u4eec\u5c06\u5b66\u4e60\u7684\u77e5\u8bc6\u91cf\u975e\u5e38\u5927\uff0c\u8fd9\u53ef\u80fd\u662f\u5f88\u591a\u5f00\u6e90\u9879\u76ee\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u8981\u628a\u8fd9\u4e9b\u529f\u80fd\u7684\u5b9e\u73b0\u6210\u672c\u964d\u4f4e\u3002",source:"@site/docs/yakexamples/yak_misc.mdx",sourceDirName:"yakexamples",slug:"/yakexamples/yak_misc",permalink:"/docs/yakexamples/yak_misc",editUrl:"https://github.com/yaklang/docs/yakexamples/yak_misc.mdx",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:'YAK \u4e2d\u7f16\u5199"\u591a\u7ebf\u7a0b/\u591a\u5e76\u53d1"\u5e94\u7528',permalink:"/docs/yakexamples/concurrent"},next:{title:"\u51fd\u6570\u5e93\uff1afuzz - \u6a21\u7cca\u6d4b\u8bd5 HTTP",permalink:"/docs/yakexamples/fuzz-request"}},l=[{value:"\u4fe1\u606f\u6536\u96c6\u6d41\u7a0b\u8bbe\u8ba1",id:"\u4fe1\u606f\u6536\u96c6\u6d41\u7a0b\u8bbe\u8ba1",children:[]},{value:"0x01 \u5904\u7406\u7528\u6237\u8f93\u5165",id:"0x01-\u5904\u7406\u7528\u6237\u8f93\u5165",children:[{value:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757",id:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757",children:[]},{value:"Show Me the Code\uff01",id:"show-me-the-code",children:[]}]},{value:"0x02 \u8fdb\u884c\u7aef\u53e3\u626b\u63cf",id:"0x02-\u8fdb\u884c\u7aef\u53e3\u626b\u63cf",children:[{value:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757",id:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757-1",children:[]},{value:"Show Me the Code!",id:"show-me-the-code-1",children:[]}]},{value:"0x03 \u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6",id:"0x03-\u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6",children:[{value:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757",id:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757-2",children:[]},{value:"Show Me the Code!",id:"show-me-the-code-2",children:[]}]},{value:"0x04 \u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6\u7684\u7ed3\u679c\u4ea4\u7ed9\u7aef\u53e3\u626b\u63cf",id:"0x04-\u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6\u7684\u7ed3\u679c\u4ea4\u7ed9\u7aef\u53e3\u626b\u63cf",children:[{value:"Show Me the Code!",id:"show-me-the-code-3",children:[]}]},{value:"0x05 \u5982\u4f55\u628a\u4fdd\u5b58\u5230\u672c\u5730\u6587\u4ef6\uff1f",id:"0x05-\u5982\u4f55\u628a\u4fdd\u5b58\u5230\u672c\u5730\u6587\u4ef6",children:[{value:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757",id:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757-3",children:[]},{value:"Show Me the Code!",id:"show-me-the-code-4",children:[]}]},{value:"0x06 \u6700\u7ec8\u5f62\u6001 96 \u884c\uff01",id:"0x06-\u6700\u7ec8\u5f62\u6001-96-\u884c",children:[]},{value:"0x07 \u7ed3\u8bed",id:"0x07-\u7ed3\u8bed",children:[]}],g={toc:l},c="wrapper";function d(n){let{components:e,...i}=n;return(0,t.yg)(c,(0,r.A)({},g,i,{components:e,mdxType:"MDXLayout"}),(0,t.yg)("h1",{id:"\u5b9e\u62181-\u626b\u7aef\u53e3\u5b50\u57df\u540d\u6307\u7eb9\u8bc6\u522b"},"\u5b9e\u62181: \u626b\u7aef\u53e3/\u5b50\u57df\u540d+\u6307\u7eb9\u8bc6\u522b"),(0,t.yg)("p",null,"\u672c\u5c4a\u6211\u4eec\u5c06\u5b66\u4e60\u7684\u77e5\u8bc6\u91cf\u975e\u5e38\u5927\uff0c\u8fd9\u53ef\u80fd\u662f\u5f88\u591a\u5f00\u6e90\u9879\u76ee\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u8981\u628a\u8fd9\u4e9b\u529f\u80fd\u7684\u5b9e\u73b0\u6210\u672c\u964d\u4f4e\u3002"),(0,t.yg)("p",null,"\u4e4b\u524d\u6211\u4eec\u8981\u5b8c\u6210\u8fd9\u4e9b\u529f\u80fd\uff0c\u53ef\u80fd\u9700\u8981\u4e00\u4e2a\u8bed\u8a00\u7684\u5f88\u591a\u7684\u5e93\uff0c\u7136\u800c\u5728 Yak \u4e2d\uff0c\u8fd9\u4e9b\u5168\u90e8\u88ab\u5c01\u88c5\u5728\u4e86\u4e00\u4e2a\u4e2a\u7684\u5185\u7f6e\u6a21\u5757\u4e2d\u3002"),(0,t.yg)("h2",{id:"\u4fe1\u606f\u6536\u96c6\u6d41\u7a0b\u8bbe\u8ba1"},"\u4fe1\u606f\u6536\u96c6\u6d41\u7a0b\u8bbe\u8ba1"),(0,t.yg)("p",null,(0,t.yg)("img",{alt:"\u6d41\u7a0b\u56fe",src:a(60666).A})),(0,t.yg)("p",null,"\u8fd9\u4e2a\u6d41\u7a0b\u867d\u7136\u4e5f\u5e76\u6ca1\u6709\u4ec0\u4e48\u7279\u6b8a\u7684\uff0c\u4e5f\u5e76\u6ca1\u6709\u4efb\u4f55\u7279\u8272\uff0c\u751a\u81f3\u5927\u5bb6\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4ef6\u5f88\u7b80\u5355\u7684\u4e8b\u60c5\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\uff0c\u5e02\u9762\u4e0a\u60f3\u8981\u627e\u5230\u4e00\u4e2a\u8fd9\u4e48\u7b80\u5355\u7684\u6d41\u7a0b\uff0c\u4e5f\u5e76\u4e0d\u662f\u4e00\u4ef6\u5bb9\u6613\u7684\u4e8b\u60c5\u3002"),(0,t.yg)("p",null,"\u5f88\u591a\u4f18\u79c0\u7684\u5de5\u5177\uff0c\u53ea\u5b9e\u73b0\u4e86\u5176\u4e2d\u7684\u4e00\u90e8\u5206\uff0c\u800c\u4e14\u548c\u5176\u4ed6\u5de5\u5177\u7684\u914d\u5408/\u8054\u52a8\uff0c\u5e76\u4e0d\u662f\u7279\u522b\u7684\u8212\u670d\u3002"),(0,t.yg)("p",null,"\u4e8e\u662f\u5e02\u9762\u4e0a\u51fa\u73b0\u4e86\u4e00\u5927\u6279\u7f1d\u5408\u9879\u76ee\uff0c\u4f46\u662f\u7f1d\u5408\u9879\u76ee\u4e5f\u662f\u6709\u4ee3\u4ef7\u7684\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u4f9d\u8d56\uff0c\u6216\u8005\u628a\u6574\u4e2a\u9879\u76ee\u8fd0\u884c\u5728 docker \u4e2d\u3002\u7531\u4e8e\u5f88\u591a\u7528\u6237\u7f3a\u4e4f docker \u4f7f\u7528\u7ecf\u9a8c\uff0c\u4e5f\u61d2\u5f97\u53bb\u5b89\u88c5\u8bed\u8a00\u4ee5\u53ca\u5bf9\u5e94\u4f9d\u8d56\n\u5bfc\u81f4\u8fd9\u4e9b\u9879\u76ee\u8fd0\u884c\u7684\u6548\u679c\u5e76\u4e0d\u591f\u7406\u60f3\u3002"),(0,t.yg)("p",null,"\u7136\u800c\u5728 yak \u4e2d\uff0c\u4e0a\u8ff0\u95ee\u9898\u90fd\u5f97\u5230\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u7684\u89e3\u51b3\u3002"),(0,t.yg)("h2",{id:"0x01-\u5904\u7406\u7528\u6237\u8f93\u5165"},"0x01 \u5904\u7406\u7528\u6237\u8f93\u5165"),(0,t.yg)("h3",{id:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757"},"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757"),(0,t.yg)("p",null,"\u6211\u4eec\u5185\u90e8\u4f9d\u8d56\u7684\u6a21\u5757\u5e76\u4e0d\u9700\u8981\u7528\u6237\u53bb\u5bfc\u5165\uff0c\u76f4\u63a5\u4f7f\u7528\u5373\u53ef\uff01"),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("inlineCode",{parentName:"li"},"cli"),"\uff1a\u53ef\u4ee5\u5904\u7406\u7528\u6237\u4ece\u547d\u4ee4\u884c\u8f93\u5165\u7684\u53c2\u6570\u3002"),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("inlineCode",{parentName:"li"},"str"),"\uff1a\u5e38\u89c1\u5904\u7406\u5b57\u7b26\u4e32\u7684\u6a21\u5757\uff0c\u7528\u4e8e\u89e3\u6790\u626b\u63cf\u76ee\u6807\uff0c\u5224\u65ad\u5b57\u7b26\u4e32\u5185\u5bb9\u7c7b\u578b\u7b49\u64cd\u4f5c\u3002")),(0,t.yg)("h3",{id:"show-me-the-code"},"Show Me the Code\uff01"),(0,t.yg)("p",null,"\u6211\u4eec\u5728\u5904\u7406\u7528\u6237\u8f93\u5165\u7684\u65f6\u5019\uff0c\u5f80\u5f80\u9700\u8981\u4f7f\u7528 ",(0,t.yg)("inlineCode",{parentName:"p"},"cli")," \u8fd9\u4e2a\u4e13\u95e8\u7528\u6765\u5904\u7406\u7528\u6237\u8f93\u5165\u7684\u5305"),(0,t.yg)("p",null,"\u6587\u6863\u5728\u8fd9\u91cc ",(0,t.yg)("a",{parentName:"p",href:"/api-manual/api/cli"},(0,t.yg)("inlineCode",{parentName:"a"},"cli")," \u5b98\u65b9\u624b\u518c")),(0,t.yg)("p",null,"\u6211\u4eec\u6839\u636e\u6587\u6863\u7f16\u5199\u4e86\u5982\u4e0b\u4ee3\u7801\uff0c"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go",metastring:'title="yakmisc.yak"',title:'"yakmisc.yak"'},'targets := cli.String("target", cli.setHelp("\u626b\u63cf\u76ee\u6807"))\nscanTargets := str.ParseStringToHosts(targets)\nif len(scanTargets) <= 0 {\n    die("empty target is not allowed")\n}\n\nlog.setLevel("info")\nfor _, target := range scanTargets {\n    if str.IsIPv4(target) {\n        log.info("start to handle target ip: %v", target)\n    } else {\n        log.info("start to handle domain: %v", target)\n    }\n}\n')),(0,t.yg)("p",null,"\u5f53\u6211\u4eec\u7f16\u5199\u4e0a\u8ff0\u5c0f\u4ee3\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-bash"},"yak yakmisc.yak --target 192.168.1.23/29,example.com\n")),(0,t.yg)("p",null,"\u83b7\u53d6\u5230\u7684\u7ed3\u679c\u4e3a"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go"},"[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle target ip: 192.168.1.16\n[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle target ip: 192.168.1.17\n[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle target ip: 192.168.1.18\n[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle target ip: 192.168.1.19\n[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle target ip: 192.168.1.20\n[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle target ip: 192.168.1.21\n[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle target ip: 192.168.1.22\n[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle target ip: 192.168.1.23\n[INFO] 2021-07-01 11:57:28 +0800 [yakmisc] start to handle domain: example.com\n")),(0,t.yg)("p",null,"\u6211\u4eec\u89c2\u5bdf\u7ed3\u679c\uff1a\u53d1\u73b0\u6211\u4eec\u7684\u4ee3\u7801\u5df2\u7ecf\u53ef\u4ee5\u628a\u57df\u540d\u548c IP \u5206\u5f00\u4e86\uff0c\u4ece\u800c\u8fdb\u884c\u5206\u522b\u5904\u7406"),(0,t.yg)("h2",{id:"0x02-\u8fdb\u884c\u7aef\u53e3\u626b\u63cf"},"0x02 \u8fdb\u884c\u7aef\u53e3\u626b\u63cf"),(0,t.yg)("h3",{id:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757-1"},"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757"),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("inlineCode",{parentName:"li"},"cli")," \u63a5\u6536\u8f93\u5165\u7684\u7aef\u53e3\u53c2\u6570"),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("inlineCode",{parentName:"li"},"servicescan")," \u670d\u52a1\u6307\u7eb9\u626b\u63cf")),(0,t.yg)("h3",{id:"show-me-the-code-1"},"Show Me the Code!"),(0,t.yg)("p",null,"\u5f53\u6211\u4eec\u53ef\u4ee5\u987a\u5229\u63a5\u53d7\u76ee\u6807\u4e4b\u540e\uff0c\u626b\u63cf\u7aef\u53e3\u5176\u5b9e\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u4e8b\u60c5\uff0c\u5728\u6211\u4eec\u4e4b\u524d\u7684\u5c0f\u8bfe\u7a0b\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u5b66\u4f1a\u4e86\u5982\u4f55\u4f7f\u7528 ",(0,t.yg)("inlineCode",{parentName:"p"},"servicescan")," \u548c ",(0,t.yg)("inlineCode",{parentName:"p"},"synscan")," \u4e86\u3002"),(0,t.yg)("p",null,"\u4e0e\u6b64\u540c\u65f6\uff0c\u6211\u4eec\u4e5f\u5b66\u4e60\u8fc7\u5982\u4f55\u7f16\u5199 YAK \u7684\u5e76\u53d1\u7a0b\u5e8f\u3002"),(0,t.yg)("p",null,"\u6240\u4ee5\u6211\u4eec\u7f16\u5199\u8fd9\u4e2a\u90e8\u5206\u5176\u5b9e\u662f\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u4ee5\u53ea\u4f7f\u7528 servicescan \u4e3a\u4f8b\uff1a"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go"},'log.setLevel("info")\n\ntargets := cli.String("target", cli.setHelp("\u626b\u63cf\u76ee\u6807"))\nscanTargets := str.ParseStringToHosts(targets)\nif len(scanTargets) <= 0 {\n    die("empty target is not allowed")\n}\n\nports = cli.String("ports", cli.setDefault("80,8080-8082,443"))\nscanPortWg := sync.NewSizedWaitGroup(10)\n\n// \u5904\u7406\u6307\u7eb9\u626b\u63cf\u7684\u7ed3\u679c\nhandleTarget = func(result) {\n    log.debug("found result: %v", result.String())\n    if result.IsOpen() {\n        log.info("scanned fingerprint %v", result.String())\n    }\n}\n\n// \u5904\u7406\u626b\u63cf IP \u7684\u4efb\u52a1\uff0c\u4f7f\u7528 scanPortWg \u8fdb\u884c\u5e76\u53d1\u63a7\u5236\nfunc scanIPTargets(targetIP) {\n    scanPortWg.Add()\n\n    go func(){\n        defer scanPortWg.Done()\n\n        res, err := servicescan.Scan(targetIP, ports)\n        if err != nil {\n            log.error("servicescan %v ports:%v failed: %s", targetIP, ports, err)\n            return\n        }\n\n        for result := range res {\n            handleTarget(result)\n        }\n    }()\n\n}\n\nfor _, target := range scanTargets {\n    if str.IsIPv4(target) {\n        log.info("start to handle target ip: %v", target)\n        scanIPTargets(target)\n    } else {\n        log.info("start to handle domain: %v", target)\n    }\n}\n\nwg := sync.NewWaitGroup()\nwg.Add(1)\ngo func {\n    defer wg.Done()\n    scanPortWg.Wait()\n}\n\nwg.Wait()\n')),(0,t.yg)("p",null,"\u6211\u4eec\u5b9e\u73b0\u4e0a\u8ff0\u4ee3\u7801\u4e4b\u540e\uff0c\u5176\u5b9e\u53ef\u4ee5\u5b9e\u73b0\u4e00\u6761\u7ebf\u8def\u7684\u626b\u63cf\uff0c\u53ef\u4ee5\u5b9e\u73b0\u626b\u63cf\u76ee\u6807\u4e2d\u7684\u7f51\u6bb5\u548cIP\u7b49\u3002\u4f46\u662f\u79bb\u6211\u4eec\u81ea\u52a8\u8fdb\u884c\u57df\u540d\u6536\u96c6\u4ecd\u7136\u8fd8\u5dee\u4e00\u70b9\uff0c\u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u4e3b\u8981\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528 ",(0,t.yg)("inlineCode",{parentName:"p"},"subdomain")," \u6a21\u5757"),(0,t.yg)("h2",{id:"0x03-\u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6"},"0x03 \u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6"),(0,t.yg)("p",null,"\u6211\u4eec\u5b8c\u6210\u4e4b\u524d\u7684\u4ee3\u7801\u53ef\u4ee5\u9488\u5bf9 IP \u8fdb\u884c\u626b\u63cf\u4e86\uff0c\u4f46\u662f\u8fd9\u8fd8\u4e0d\u591f\uff0c\u6211\u4eec\u5e0c\u671b\u53ef\u4ee5\u9488\u5bf9\u57df\u540d\u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6\u76f8\u5173\u7684\u5de5\u4f5c\uff1a"),(0,t.yg)("h3",{id:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757-2"},"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757"),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("a",{parentName:"li",href:"/api-manual/buildinlibs/lib_subdomain"},(0,t.yg)("inlineCode",{parentName:"a"},"subdomain"),"\u7684\u4f7f\u7528\u6559\u7a0b")),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("a",{parentName:"li",href:"/api-manual/api/subdomain"},(0,t.yg)("inlineCode",{parentName:"a"},"subdomain"),"\u6240\u6709\u53ef\u7528API\u4e0e\u53c2\u6570\u914d\u7f6e\u624b\u518c"))),(0,t.yg)("h3",{id:"show-me-the-code-2"},"Show Me the Code!"),(0,t.yg)("p",null,"\u5728\u540c\u5b66\u4eec\u9605\u8bfb\u4e86\u4e0a\u8ff0\u4e24\u4e2a\u6587\u6863\u7684\u4e4b\u540e\uff0c\u6211\u4eec\u76f8\u4fe1\u5f88\u5bb9\u6613\u5c06\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u7b80\u5355\u7ed3\u5408\u4e86\u6211\u4eec\u7684\u5e76\u53d1\u9650\u5236\u7684\u529f\u80fd\u4e4b\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u5982\u4e0b\u5e26\u603b\u4f53\u5e76\u53d1\u9650\u5236\u7684\u5b50\u57df\u540d\u68c0\u6d4b\uff1a"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go"},'...\n...\n\nscanDomainWg := sync.NewSizedWaitGroup(10)\nscanDomain = func(domain) {\n    scanDomainWg.Add()\n    go func{\n        defer scanDomainWg.Done()\n        defer fn{\n            err = recover()\n            if err != nil {\n                log.error("panic from scan Domain", err)\n            }\n        }\n        log.info("start to find subdomain for: %v", domain)\n        res, err := subdomain.Scan(domain, subdomain.recursive(true))\n        if err != nil {\n            log.error("subdomain scan[%s] failed: %s", domain, err)\n            return\n        }\n        for result := range res {\n            result.Show()\n        }\n    }\n}\n\n...\n...\n')),(0,t.yg)("p",null,"\u6211\u4eec\u7f16\u5199\u5b8c\u6838\u5fc3\u5de5\u4f5c\u51fd\u6570\u4e4b\u540e\uff0c\u628a\u4e0a\u8ff0\u4ee3\u7801\u585e\u8fdb\u4e4b\u524d\u7684\u4ee3\u7801\u4e2d\u3002\u7136\u540e\u6267\u884c\u4e00\u4e0b\u547d\u4ee4\u884c\u626b\u63cf\u4e00\u4e0b\u4e00\u4e9b\u4e92\u8054\u7f51\u8d44\u4ea7"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go"},"yak yakmisc.yak --target 47.5********05/24,b********.com --ports 80\n")),(0,t.yg)("p",null,"\u5728\u6574\u5408\u5b8c\u4e4b\u540e"),(0,t.yg)("p",null,"\u5728\u8fd9\u4e2a\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u4ec5\u4ec5\u628a\u7ed3\u679c\u6253\u5370\u51fa\u6765\uff0c\u5728\u63a7\u5236\u53f0\u6211\u4eec\u9664\u4e86\u4e4b\u524d\u7684\u626b\u63cf\u7aef\u53e3\u7684\u7ed3\u679c\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u4e00\u76f4\u5f97\u5230\u4e00\u4e9b\u5176\u4ed6\u7ed3\u679c"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-bash"},"    b*******der-111-*******-20.craw*******.com IP:[ 111.20*******0] From:[https://api.sublist3r.com/search.php?domain=**********.com]\n       bai*******r-1*******71-98.craw*******.com IP:[  12*******1.98] From:[https://api.sublist3r.com/search.php?domain=**********.com]\n                                  in*******u.com IP:[111.*******.224] From:[]\n                          lyncdiscover*******com IP:[ 111*******5.71] From:[]\n                                port*******u.com IP:[    1*******.82] From:[]\n                          river.zhid*******u.com IP:[ 220.*******133] From:[https://crt.sh/?q=%25.**********.com]\n                                ima*******du.com IP:[   18*******.50] From:[]\n                               finfe*******u.com IP:[  120*******131] From:[https://crt.sh/?q=%25.**********.com]\n[INFO] 2021-07-01 14:24:07 +0800 [yakmisc] scanned fingerprint tcp://*******00.22:80     open   nginx[*]/php[*]\n[INFO] 2021-07-01 14:24:07 +0800 [yakmisc] start to handle target ip:*******100.37\n[INFO] 2021-07-01 14:24:08 +0800 [yakmisc] scanned fingerprint tcp://47.*******21:80     open   gitlab[*]/nginx[*]\n[INFO] 2021-07-01 14:24:08 +0800 [yakmisc] start to handle target ip: 47*******.38\n                                   n*******u.com IP:[  112*******.64] From:[]\n      b*******der-111-*******-76.cra*******u.com IP:[ 111*******8.76] From:[https://api.sublist3r.com/search.php?domain=**********.com]\n                                sta*******du.com IP:[111.*******.240] From:[]\n      b*******der-116-*******172.cr*******du.com IP:[ 116*******.172] From:[https://api.sublist3r.com/search.php?domain=**********.com]\n                                  h*******du.com IP:[ 11*******09.69] From:[]\n                              downl*******du.com IP:[ 111.*******.32] From:[]\n                                   *******du.com IP:[   1*******3.10] From:[]\n                                   *******du.com IP:[124.2*******254] From:[]\n[INFO] 2021-07-01 14:24:11 +0800 [yakmisc] start to handle target ip: 4*******0.39\n[INFO] 2021-07-01 14:24:11 +0800 [yakmisc] start to handle target ip: 4*******0.40\n[INFO] 2021-07-01 14:24:11 +0800 [yakmisc] scanned fingerprint tcp://47.*******:80     open   apache[*]/http_server[*]\n[INFO] 2021-07-01 14:24:11 +0800 [yakmisc] start to handle target ip: 47********.41\n[INFO] 2021-07-01 14:24:11 +0800 [yakmisc] scanned fingerprint tcp://47*******.35:80     open   iis[7.5]/int\n")),(0,t.yg)("h2",{id:"0x04-\u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6\u7684\u7ed3\u679c\u4ea4\u7ed9\u7aef\u53e3\u626b\u63cf"},"0x04 \u8fdb\u884c\u5b50\u57df\u540d\u6536\u96c6\u7684\u7ed3\u679c\u4ea4\u7ed9\u7aef\u53e3\u626b\u63cf"),(0,t.yg)("p",null,"\u5f53\u6211\u4eec\u5b8c\u6210\u4e0a\u8ff0\u626b\u63cf\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u5fc3\u91cc\u5df2\u7ecf\u6709\u6570\u4e86\uff0cIP\u548c\u57df\u540d\u6211\u4eec\u90fd\u4f7f\u7528\u4e86\u4e0d\u540c\u7684\u626b\u63cf\u7b56\u7565\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\uff0c\u57df\u540d\u7684\u626b\u63cf\u5e76\u6ca1\u6709\u8fbe\u5230\u6211\u4eec\u60f3\u8981\u7684\u6548\u679c\uff0c\u6211\u4eec\u60f3\u628a\u57df\u540d\u626b\u63cf\u4ea7\u751f\u7684\u7ed3\u679c\u76f4\u63a5\u4ea4\u7ed9\u7aef\u53e3\u626b\u63cf\u53bb\u626b\u63cf\u6307\u7eb9\u3002"),(0,t.yg)("p",null,"\u867d\u7136\u73b0\u5728\u6211\u4eec\u5bf9\u57df\u540d\u626b\u63cf\u7684\u7ed3\u679c\u4f7f\u7528\u975e\u5e38\u7b80\u5355\u4ec5\u4ec5\u662f"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go",metastring:"{6-8}","{6-8}":!0},'res, err := subdomain.Scan(domain, subdomain.recursive(true))\nif err != nil {\n    log.error("subdomain scan[%s] failed: %s", domain, err)\n    return\n}\nfor result := range res {\n    result.Show()\n}\n')),(0,t.yg)("p",null,"\u6211\u4eec\u628a\u57df\u540d\u6536\u96c6\u7684\u7ed3\u679c\u6253\u5370\u51fa\u6765\u5230\u5c4f\u5e55\u4e0a\u4e86\uff0c\u7136\u800c\u8fd9\u5e76\u6ca1\u6709\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002\u5176\u5b9e\u53ea\u9700\u8981\u628a ",(0,t.yg)("inlineCode",{parentName:"p"},"result")," \u4e2d\u7684 IP \u5730\u5740\u53d6\u51fa\u6765\uff0c\u91cd\u65b0\u4ea4\u7ed9\u7aef\u53e3\u626b\u63cf/\u6307\u7eb9\u626b\u63cf\u5373\u53ef"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go",metastring:"{6-8,9}","{6-8,9}":!0},'res, err := subdomain.Scan(domain, subdomain.recursive(true))\nif err != nil {\n    log.error("subdomain scan[%s] failed: %s", domain, err)\n    return\n}\nfor result := range res {\n    result.Show()\n    scanIPTargets(result.IP)\n}\n')),(0,t.yg)("div",{className:"admonition admonition-info alert alert--info"},(0,t.yg)("div",{parentName:"div",className:"admonition-heading"},(0,t.yg)("h5",{parentName:"div"},(0,t.yg)("span",{parentName:"h5",className:"admonition-icon"},(0,t.yg)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.yg)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.yg)("div",{parentName:"div",className:"admonition-content"},(0,t.yg)("p",{parentName:"div"},"\u5982\u679c\u7528\u6237\u4e0d\u719f\u6089 ",(0,t.yg)("inlineCode",{parentName:"p"},"subdomain")," \u4e2d\u6709\u5565\u5b57\u6bb5\u53ef\u4ee5\u4f7f\u7528\uff0c\u53ef\u4ee5\u53c2\u8003\u6587\u6863 ",(0,t.yg)("a",{parentName:"p",href:"/api-manual/buildinlibs/lib_subdomain#%E6%A0%B8%E5%BF%83%E5%87%BD%E6%95%B0%E4%B8%8E%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"},(0,t.yg)("inlineCode",{parentName:"a"},"subdomain")," \u4e2d\u7684\u7ed3\u679c\u5904\u7406")),(0,t.yg)("pre",{parentName:"div"},(0,t.yg)("code",{parentName:"pre",className:"language-go"},"type palm/common/subdomain.(SubdomainResult) struct {\n  Fields(\u53ef\u7528\u5b57\u6bb5):\n      // \u539f\u6765\u7684\u57df\u540d\u662f\u8c01\uff1f\n      FromTarget: string\n\n      // \u6765\u6e90\u4e8e\u54ea\u4e2a DNS \u670d\u52a1\u5668\u7684\u76f8\u5e94\uff1f\n      FromDNSServer: string\n\n      FromModeRaw: int // \u7565\n\n      // \u8fd9\u4e2a\u57df\u540d\u5bf9\u5e94\u7684 IP \u662f\u591a\u5c11\n      IP: string\n\n      // \u57df\u540d\u672c\u8eab\u7684\u4fe1\u606f\n      Domain: string\n\n      // \u989d\u5916\u4fe1\u606f\n      Tags: []string\n  StructMethods(\u7ed3\u6784\u65b9\u6cd5/\u51fd\u6570):\n  PtrStructMethods(\u6307\u9488\u7ed3\u6784\u65b9\u6cd5/\u51fd\u6570):\n      func Hash() return(string)\n\n      // \u5c55\u793a\u5230 Stdout\n      func Show()\n\n      // \u8f93\u51fa\u6210\u5b57\u7b26\u4e32\u683c\u5f0f\n      func ToString() return(string)\n}\n")),(0,t.yg)("p",{parentName:"div"},"\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u589e\u52a0\u4e00\u884c ",(0,t.yg)("inlineCode",{parentName:"p"},"scanIPTargets(result.IP)"),"\uff0c\u5c31\u53ef\u4ee5\u628a\u57df\u540d\u626b\u63cf\u7684\u7ed3\u679c\u76f4\u63a5\u8f93\u5165\u7aef\u53e3\u626b\u63cf\u7ed3\u679c\u8fdb\u884c\u626b\u63cf\u4e86"))),(0,t.yg)("h3",{id:"show-me-the-code-3"},"Show Me the Code!"),(0,t.yg)("p",null,"\u5f53\u6211\u4eec\u628a\u4e0a\u9762\u6240\u6709\u7684\u5185\u5bb9\u548c\u6d41\u7a0b\u7406\u89e3\u4e86\u4e4b\u540e\uff0c\u6211\u4eec\u4fee\u6539\u4e86\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u5b8c\u6574\u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"yakmisc.yak")," \u811a\u672c"),(0,t.yg)("p",null,"\u5927\u5bb6\u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go"},"yak yakmisc.yak --target 192.168.1.1/24,example.com,10.3.1.0/24\n")),(0,t.yg)("div",{className:"admonition admonition-caution alert alert--warning"},(0,t.yg)("div",{parentName:"div",className:"admonition-heading"},(0,t.yg)("h5",{parentName:"div"},(0,t.yg)("span",{parentName:"h5",className:"admonition-icon"},(0,t.yg)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,t.yg)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,t.yg)("div",{parentName:"div",className:"admonition-content"},(0,t.yg)("p",{parentName:"div"},"\u5f53\u7136\uff0c\u4f60\u9700\u8981\u8bb0\u5f97\u628a\u626b\u63cf\u76ee\u6807\u6362\u6210\u771f\u6b63\u4f60\u60f3\u8981\u7684\u626b\u63cf\u76ee\u6807"))),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go",metastring:'title="yakmisc.yak"',title:'"yakmisc.yak"'},'log.setLevel("info")\n\ntargets := cli.String("target", cli.setHelp("\u626b\u63cf\u76ee\u6807"))\nscanTargets := str.ParseStringToHosts(targets)\nif len(scanTargets) <= 0 {\n    die("empty target is not allowed")\n}\n\nports = cli.String("ports", cli.setDefault("80,8080-8082,443"))\nscanPortWg := sync.NewSizedWaitGroup(10)\n\n// \u5904\u7406\u6307\u7eb9\u626b\u63cf\u7684\u7ed3\u679c\nhandleTarget = func(result) {\n    log.debug("found result: %v", result.String())\n    if result.IsOpen() {\n        log.info("scanned fingerprint %v", result.String())\n    }\n}\n\nscanIPTargets = func(targetIP) {\n    scanPortWg.Add()\n\n    go func(){\n        defer scanPortWg.Done()\n\n        log.info("start to handle target ip: %v", targetIP)\n        res, err := servicescan.Scan(targetIP, ports)\n        if err != nil {\n            log.error("servicescan %v ports:%v failed: %s", targetIP, ports, err)\n            return\n        }\n\n        for result := range res {\n            handleTarget(result)\n        }\n    }()\n\n}\n\nscanDomainWg := sync.NewSizedWaitGroup(10)\nscanDomain = func(domain) {\n    scanDomainWg.Add()\n    go func{\n        defer scanDomainWg.Done()\n        defer fn{\n            err = recover()\n            if err != nil {\n                log.error("panic from scan Domain", err)\n            }\n        }\n        log.info("start to find subdomain for: %v", domain)\n        res, err := subdomain.Scan(domain, subdomain.recursive(true))\n        if err != nil {\n            log.error("subdomain scan[%s] failed: %s", domain, err)\n            return\n        }\n        for result := range res {\n            result.Show()\n            scanIPTargets(result.IP)\n        }\n    }\n}\n\nfor _, target := range scanTargets {\n    if str.IsIPv4(target) {\n        scanIPTargets(target)\n    } else {\n        log.info("start to handle domain: %v", target)\n        scanDomain(target)\n    }\n}\n\nwg := sync.NewWaitGroup()\nwg.Add(1)\ngo func {\n    defer wg.Done()\n    scanPortWg.Wait()\n}\nwg.Add(1)\ngo func{\n    defer wg.Done()\n    scanDomainWg.Wait()\n}\n\nwg.Wait()\n')),(0,t.yg)("p",null,"\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u60f3\u8981\u7684\u6d41\u7a0b\u56fe\u4e2d\u7684\u529f\u80fd\uff0c\u57fa\u672c\u5df2\u7ecf\u5b8c\u6210\u5dee\u4e0d\u591a\u4e86\uff0c\u6838\u5fc3\u529f\u80fd\u5b8c\u6210\u4e86\uff0c\u96be\u9053\u6700\u7b80\u5355\u7684\u628a\u6587\u4ef6\u4fdd\u5b58\u5728\u672c\u5730\u4f1a\u662f\u4e00\u4ef6\u96be\u4e8b\u5417\uff1f"),(0,t.yg)("p",null,"\u663e\u7136\u4e0d\u662f\uff01"),(0,t.yg)("h2",{id:"0x05-\u5982\u4f55\u628a\u4fdd\u5b58\u5230\u672c\u5730\u6587\u4ef6"},"0x05 \u5982\u4f55\u628a\u4fdd\u5b58\u5230\u672c\u5730\u6587\u4ef6\uff1f"),(0,t.yg)("p",null,"\u6d89\u53ca\u5230\u6587\u4ef6\u8bfb\u5199\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528 yak \u5185\u7f6e\u7684\u6587\u4ef6\u8bfb\u5199\u5e93 ",(0,t.yg)("inlineCode",{parentName:"p"},"file")),(0,t.yg)("p",null,"\u8fd9\u4e2a\u5e93\u662f\u5728 Golang \u539f\u751f\u7684\u6587\u4ef6\u8bfb\u5199\u4e0a\u5305\u88f9\u51fa\u6765\u7684\u63a5\u53e3\uff0c\u975e\u5e38\u7b80\u5355\u6613\u7528"),(0,t.yg)("h3",{id:"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757-3"},"\u5185\u90e8\u4f9d\u8d56\u6a21\u5757"),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("a",{parentName:"li",href:"/api-manual/buildinlibs/lib_file"},(0,t.yg)("inlineCode",{parentName:"a"},"file")," \u6587\u4ef6\u8bfb\u5199"))),(0,t.yg)("h3",{id:"show-me-the-code-4"},"Show Me the Code!"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go"},'// \u4ece\u547d\u4ee4\u884c\u83b7\u53d6\u6587\u4ef6\u540d\uff0c\u5982\u679c\u7528\u6237\u6ca1\u6709\u8f93\u5165\uff0c\u6211\u4eec\u81ea\u5b9a\u4e49\u4e00\u4e2a\u968f\u673a\u6587\u4ef6\u540d\ndomainFileName = cli.String("domain-result", cli.setDefault(sprintf("yakmisc-domain-result-%v.txt", randstr(15))))\n\n// \u6253\u5f00/\u521b\u5efa\u8fd9\u4e2a\u968f\u673a\u7684\u6587\u4ef6\u540d\ndomainResult, err = file.Open(domainFileName)\n\n// \u5982\u679c\u6253\u5f00\u6587\u4ef6\u5931\u8d25\uff0c\u5219\u63a8\u51fa\u811a\u672c\ndie(err)\n\n// \u628a domainResult \u6587\u4ef6\u53ca\u65f6\u5173\u95ed\ndefer domainResult.Close()\n')),(0,t.yg)("h2",{id:"0x06-\u6700\u7ec8\u5f62\u6001-96-\u884c"},"0x06 \u6700\u7ec8\u5f62\u6001 96 \u884c\uff01"),(0,t.yg)("p",null,"\u5f53\u6211\u4eec\u628a\u6240\u6709\u4e0a\u8ff0\u7ec6\u8282\u4ee3\u7801\u6574\u5408\u5728\u4e00\u8d77\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u4ec5\u4ec5 96 \u884c\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u4ece\u5b50\u57df\u540d\u5230\u7aef\u53e3\u626b\u63cf\u7684\u5168\u90e8\u529f\u80fd\u3002"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go",metastring:'title="yakmisc.yak"',title:'"yakmisc.yak"'},'log.setLevel("info")\n\nresultFileName = cli.String("port-result", cli.setDefault(sprintf("yakmisc-port-result-%v.txt", randstr(15))))\ndomainFileName = cli.String("domain-result", cli.setDefault(sprintf("yakmisc-domain-result-%v.txt", randstr(15))))\nportResult, err = file.Open(resultFileName)\ndie(err)\ndefer portResult.Close()\ndomainResult, err = file.Open(domainFileName)\ndie(err)\ndefer domainResult.Close()\n\ntargets := cli.String("target", cli.setHelp("\u626b\u63cf\u76ee\u6807"))\nscanTargets := str.ParseStringToHosts(targets)\nif len(scanTargets) <= 0 {\n    die("empty target is not allowed")\n}\n\nports = cli.String("ports", cli.setDefault("80,8080-8082,443"))\nscanPortWg := sync.NewSizedWaitGroup(10)\n\n// \u5904\u7406\u6307\u7eb9\u626b\u63cf\u7684\u7ed3\u679c\nhandleTarget = func(result) {\n    log.debug("found result: %v", result.String())\n    if result.IsOpen() {\n        log.info("scanned fingerprint %v", result.String())\n        portResult.WriteLine(sprintf("%24s   %6s    %s", str.HostPort(result.Target, result.Port), parseStr(result.State), result.GetServiceName()))\n    }\n}\n\nscanIPTargets = func(targetIP) {\n    scanPortWg.Add()\n\n    go func(){\n        defer scanPortWg.Done()\n\n        log.info("start to handle target ip: %v", targetIP)\n        res, err := servicescan.Scan(targetIP, ports)\n        if err != nil {\n            log.error("servicescan %v ports:%v failed: %s", targetIP, ports, err)\n            return\n        }\n\n        for result := range res {\n            handleTarget(result)\n        }\n    }()\n\n}\n\nscanDomainWg := sync.NewSizedWaitGroup(10)\nscanDomain = func(domain) {\n    scanDomainWg.Add()\n    go func{\n        defer scanDomainWg.Done()\n        defer fn{\n            err = recover()\n            if err != nil {\n                log.error("panic from scan Domain", err)\n            }\n        }\n        log.info("start to find subdomain for: %v", domain)\n        res, err := subdomain.Scan(domain, subdomain.recursive(true))\n        if err != nil {\n            log.error("subdomain scan[%s] failed: %s", domain, err)\n            return\n        }\n        for result := range res {\n            result.Show()\n            domainResult.WriteLine(result.ToString())\n            scanIPTargets(result.IP)\n        }\n    }\n}\n\nfor _, target := range scanTargets {\n    if str.IsIPv4(target) {\n        scanIPTargets(target)\n    } else {\n        log.info("start to handle domain: %v", target)\n        scanDomain(target)\n    }\n}\n\nwg := sync.NewWaitGroup()\nwg.Add(1)\ngo func {\n    defer wg.Done()\n    scanPortWg.Wait()\n}\nwg.Add(1)\ngo func{\n    defer wg.Done()\n    scanDomainWg.Wait()\n}\n\nwg.Wait()\n')),(0,t.yg)("p",null,"\u5f53\u6211\u4eec\u5b8c\u6210\u4e0a\u8ff0\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u6267\u884c\u4e86\u626b\u63cf\u8fc7\u7a0b\u4e4b\u540e\uff0c\u672c\u5730\u751f\u6210\u4e86\u5982\u4e0b\u6587\u4ef6\uff1a"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-bash"},"-rwxr-xr-x   1 v1ll4n  staff   6.9K  7  1 15:36 yakmisc-domain-result-QeIYGjpFijYzKCM.txt\n-rwxr-xr-x   1 v1ll4n  staff   3.6K  7  1 15:36 yakmisc-port-result-GnSXvODjEJrZHPn.txt\n-rw-r--r--   1 v1ll4n  staff   2.5K  7  1 15:31 yakmisc.yak\n")),(0,t.yg)("p",null,"\u6211\u4eec\u7684\u626b\u63cf\u7ed3\u679c\u5df2\u7ecf\u5f97\u5230\u4e86\u3002"),(0,t.yg)("h2",{id:"0x07-\u7ed3\u8bed"},"0x07 \u7ed3\u8bed"),(0,t.yg)("p",null,"\u5728\u6211\u4eec\u7f16\u5199\u4e0a\u8ff0\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f1a\u5f88\u660e\u663e\u611f\u89c9\u5230\u6211\u4eec\u7684\u7f16\u5199\u8fc7\u7a0b\u5c31\u50cf\u642d\u79ef\u6728\u4e00\u6837\uff0c\u5e76\u4e0d\u662f\u4ece\u96f6\u5f00\u59cb\u521b\u9020\u3002"),(0,t.yg)("p",null,"Yak \u5728\u5de8\u4eba\u80a9\u8180\u4e0a\u8bde\u751f\uff0c\u7528\u6237\u5c31\u53ef\u4ee5\u770b\u5f97\u66f4\u8fdc\u3002"))}d.isMDXComponent=!0},60666:(n,e,a)=>{a.d(e,{A:()=>r});const r=a.p+"assets/images/process-ba46ee9545bae1debafbd1ccfd8c3d7d.jpg"}}]);