<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="Yak Program Language Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="Yak Program Language Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Yak Program Language" href="/en/opensearch.xml"><title data-react-helmet="true">Yak Java-Hack TemplatesImpl 升级 | Yak Program Language</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://yaklang.com/en/articles/yaklang-java-hack-upgrade"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-articles-current"><meta data-react-helmet="true" property="og:title" content="Yak Java-Hack TemplatesImpl 升级 | Yak Program Language"><meta data-react-helmet="true" name="description" content="原创 Yak  Yak Project   2024-10-25 17:30"><meta data-react-helmet="true" property="og:description" content="原创 Yak  Yak Project   2024-10-25 17:30"><link data-react-helmet="true" rel="shortcut icon" href="/en/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://yaklang.com/en/articles/yaklang-java-hack-upgrade"><link data-react-helmet="true" rel="alternate" href="https://yaklang.com/articles/yaklang-java-hack-upgrade" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://yaklang.com/en/articles/yaklang-java-hack-upgrade" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://yaklang.com/articles/yaklang-java-hack-upgrade" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.c38bde3d.css">
<link rel="preload" href="/en/assets/js/runtime~main.e478f0b7.js" as="script">
<link rel="preload" href="/en/assets/js/main.12a33ab3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title"></b></a><a class="navbar__item navbar__link diy-link-item" href="/en/docs/intro">Yak 语言文档</a><a class="navbar__item navbar__link diy-link-item" href="/en/api-manual/intro">API 手册</a><a class="navbar__item navbar__link diy-link-item" href="/en/products/intro">Yakit 使用手册</a><a class="navbar__item navbar__link diy-link-item" href="/en/articles/intro">技术博客</a><a class="navbar__item navbar__link diy-link-item" href="/en/irify">静态代码分析技术</a><a class="navbar__item navbar__link diy-link-item" href="/en/Yaklab/yaklab">YakLab 实战手册</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link diy-link-item">关于我们</a><ul class="dropdown__menu"><li><a activeclassname="dropdown__link--active" href="/en/team" to="/en/team" class="dropdown__link diy-link-item" target="_blank">关于我们</a></li><li><a activeclassname="dropdown__link--active" href="/en/cooperativePartner" to="/en/cooperativePartner" class="dropdown__link diy-link-item" target="_blank">合作伙伴</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://oss-qn.yaklang.com/yakit-technical-white-paper.pdf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link diy-link-item"><span>下载白皮书</span></a><a href="https://github.com/yaklang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link diy-link-item"><span>Github</span></a><div class="languageSwitcher"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4163" width="20" height="20"><path d="M249.7536 378.5728c10.6496 31.6416 28.3648 59.0848 53.0432 83.2512 20.992-22.7328 36.7616-50.7904 47.0016-83.2512h-100.0448zM902.2464 191.488H511.2832L488.96 71.8848H125.952c-40.0384 0-72.6016 32.5632-72.6016 72.6016v617.1648c0 40.0384 32.5632 72.6016 72.6016 72.6016h330.9568l-26.5216 119.6032h471.9616c40.0384 0 72.6016-32.5632 72.6016-72.6016V264.192c-0.1024-40.1408-32.768-72.704-72.704-72.704zM409.3952 558.1824c-42.8032-15.7696-78.1312-35.84-106.5984-59.0848-29.7984 26.5216-67.072 46.08-110.2848 58.1632l-14.9504-24.6784c42.3936-11.1616 77.7216-27.9552 105.5744-51.712-28.7744-29.3888-48.8448-63.2832-60.1088-101.888h-40.448v-27.9552h105.5744c-6.5536-12.0832-14.9504-23.7568-24.6784-34.9184l27.9552-10.24c9.728 12.5952 18.6368 27.4432 26.5216 44.7488h100.9664v27.9552h-40.448c-13.0048 40.0384-31.6416 73.5232-56.32 100.5568 27.4432 21.9136 61.8496 40.0384 102.4 54.8864 0.1024 0.2048-15.1552 24.1664-15.1552 24.1664z m529.1008 322.56a36.352 36.352 0 0 1-36.352 36.352H475.9552l18.1248-83.2512h136.2944l-77.7216-433.2544-0.4096 2.3552-3.2768-17.3056 0.9216 0.4096-28.3648-158.3104h381.1328a36.352 36.352 0 0 1 36.352 36.352v616.6528h-0.512zM643.4816 538.2144h100.1472v-26.5216h-100.1472v-53.0432h106.5984V432.128H612.2496v190.7712h141.9264v-26.5216H643.4816v-58.1632z m208.9984-57.2416c-8.3968 0-15.7696 1.3312-22.7328 5.12-6.5536 3.2768-13.0048 8.3968-18.1248 14.9504v-16.2816H781.312v138.24h30.3104v-83.2512c0.9216-11.1616 4.7104-19.5584 11.1616-25.6 5.632-5.12 12.0832-7.9872 19.5584-7.9872 20.992 0 31.1296 11.1616 31.1296 33.9968v82.432h30.3104v-85.2992c0.8192-37.6832-16.896-56.32-51.3024-56.32z" p-id="4164"></path></svg></div><div class="searchBox_fBfG"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/intro">Yak 技术博客</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/adversarial_front-end_dynamic_key_and_asymmetric_encryption_protection">渗透测试高级技巧（二）：对抗前端动态密钥与非对称加密防护</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/ai-in-yakit">在 Yakit 中让 AI 辅助你完成复杂工作</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/analyze_signature_verification_and_front-end_encryption">渗透测试高级技巧（一） ：分析验签与前端加密</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/block-scope-from-yak">Yak 中的块作用域</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/browser-crawler-and-brute">Yakit 中使用浏览器爆破的爆破插件</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/browser-proxy-plugin">Oi，不要小看Proxy浏览器插件与Yak之间的羁绊啊！</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/cli-lib-upgrade-in-yaklang">CLI参数助力MITM插件升级，起飞！</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/codec-and-yakit">Yakit技能联动：codec &amp; WebFuzzer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/cross-auth-test-for-yakit">&quot;Yaker，你可以全局配置插件环境变量!&quot;</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/diff-between-yaklang-n-yakit">Yaklang 与 Yakit 有什么区别？</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/first-poc-in-yakit">来了，秋天的第一个POC</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/goja-in-yaklang">上新！更强大的JS引擎：goja</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/java-dirty-data-in-yaklang">Java 脏数据填充探索</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/jsforward-script">一种简单又强势的Js-Forward脚本编写方式</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/mitm-upgrading">不夸张，MITM真是网安人的神器</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/mitm_hijack">不许动，你被劫持了！</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/new-codec-using">CyberChef 版 Codec 与 Codec序列</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/new-yak-runner">Yak Runner 新版本，City不City？</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/rdp-protocol-for-discovery">RDP协议探索</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/synscan_">嘿朋友，你想成为SYN扫描传奇吗？</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/syntaxflow-ez-rule-using">成魔成仙，牛牛自己说了算！</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/syntaxflow-rule-manager">使用规则管理新功能，进行新年的第一场代码审计！</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/syntaxflow-sca-rule">很好SCA规则，爱来自Syntaxflow</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/syntaxflow_">你这SyntaxFlow，保熟吗？</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/the_closure_feature_of_SSA">Yaklang中的闭包与side-effect</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/verification_code_recognition_and_blasting">拿不下总统之位，那就用热加载拿下验证码识别与爆破好了！</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/vulinbox-jwt-wp">震惊！YAK-JWT靶场的通关方式竟然是...</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/vulnerability_testing_after_being_encrypted_by_the_front-end">渗透测试高级技巧（三）：被前端加密后的漏洞测试</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/xml-test-supporting">浅谈XML模糊测试</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/yak-and-nuclei">Yak与nuclei的深度融合：打造高效漏扫生态，解锁PoC管理新姿势</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/yak-yso">实战分享：用Yak-yso解决一些常见问题</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/articles/yaklang-commandline-use">Yak 命令行扫描指南</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/en/articles/yaklang-java-hack-upgrade">Yak Java-Hack TemplatesImpl 升级</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="theme-doc-markdown markdown"><header><h1>Yak Java-Hack TemplatesImpl 升级</h1></header><p>原创 Yak  Yak Project   2024-10-25 17:30  </p><p><img src="/en/assets/images/wechat2md-57d4b38fb5fac67b077017855ed50c43-8baebdd21c36353c92a8b74aa896c98b.gif">  </p><p>Yaklang里传来，Java-hack升级啦~  </p><p>隔壁抽鞭子的黑工厂里，牛牛更新了吗~?  </p><p><img src="/en/assets/images/wechat2md-1a81b255d0eb25ee0b3db6ccbde33174-66ba03270b28c93d36440b17f01cb858.png">  </p><p><img src="/en/assets/images/wechat2md-64ccd1a8cfa82e7bce38332e033ef4d5-2449326f8b987b3f6f2dc32abdee865c.png">  </p><p><img src="/en/assets/images/wechat2md-87e553ed4974193fff8083e554f8e32b-08ac40e84bef61748a72b75087a25563.png">  </p><header><h1></h1></header><p><strong>TemplatesImpl 类：</strong><br>
TemplatesImpl对象的成员方法有一段类字节码，在反序列化时会加载并实例化这个类。通过构造序列化链使得成功反序列化<strong>包含恶意类的 TemplatesImpl 对象</strong>，从而实现任意代码执行的效果。  </p><p><strong>Transformer 类：</strong><br>
Transformer 是一个接口，其成员只有一个 transform 方法，参数和返回值都是 Object 类型，用于将一个对象按照某种规则转换为另一个对象。<strong>通过实现类 InvokerTransformer</strong>可以实现对任意对象方法的调用，再通过 ChainedTransformer 可以将多个 Transformer 串联，实现类似链式调用的操作。  </p><p>通过对比两种方式可以看出，基于TemplatesImpl 类构造的链可以通过修改TemplatesImpl 对象内的字节码，也就是恶意class实现各种功能。而Transformer链需要构造多个Transformer对象实现。  </p><p><img src="/en/assets/images/wechat2md-77b69f169364d34e396f0d68bfcd8711-4e52db8c130960ab1328bf08e65d8026.png">  </p><header><h1></h1></header><p>java在序列化一个对象时，会先递归处理成员对象，再序列化这个对象，但在递归过程可能会遇到循环引用的问题，例如：  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Object node1 = new Node();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Object node2 = new Node();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">node1.Parent = node2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">node2.Child = node1;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>在序列化node1的时候会先序列化成员Parent，开始序列化对象node2这时又会开始序列化成员Child，开始序列化对象node1......，为了防止递归过程中出现循环引用，每个对象第一次序列化时会生成一个handle值（从0x7e0000开始计数，依次递增），后面再遇到这个对象直接用handle值代替。而且不仅对象有handle，类也有handle，也就是每个类的描述也只会出现一次。  </p><p><img src="/en/assets/images/wechat2md-e70b6b7b0d73faab8078d942fd252d9f-8408793636be02883919d72faa89ac5f.png">  </p><header><h1></h1></header><p>所以如果简单的对序列化数据中的对象进行替换，会导致handle table错乱（例如同一个class在不同的序列化数据中的handle值不同）  </p><p>一种解决方案是在序列化一个模板对象时，把handle table提出来，再在序列化其它transform 链之前把handle table赋值进去，这样就能保证两次序列化中，相同class的handle值相同。另一种办法就是对于一些关键类，即使重复出现也不使用handle值，但这样可能导致序列化数据体积变大。最稳妥的办法就是对替换对象的handle table重构。  </p><p>最后一个简单的办法就是把所有transform 链都生成，再压缩，压缩后发现可能压缩算法会对这种高度相似的数据采取类似引用数据块的办法，使得压缩率特别高。  </p><p><img src="/en/assets/images/wechat2md-7f2f4748f83184e7ad25bb40a9d747fe-ba2085e8dd0e86e25650baf796ab1abf.png">  </p><header><h1></h1></header><p>加入transform链后，链子数量骤然增多，有些链子还需要搭建jdk环境，显然增加了测试的成本，所以需要写个自动化的测试。也就是需要编写一个java程序作为靶场，这个靶场需要包含所有payload的运行环境。  </p><p><img src="/en/assets/images/wechat2md-e77ae6bfdc6d3378d3d11efb338fda12-a227fdb6c39a04d1c2eb0e8c2ea278aa.png">  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="-4"></a><a class="hash-link" href="#-4" title="Direct link to heading">#</a></h2><p>由于payload涉及的依赖较多，不能一个个手工导入。而ysoserial.jar既然可以生成payload，那必然包含所有payload的依赖，所以可以将ysoserial.jar作为靶场依赖。  </p><p><img src="/en/assets/images/wechat2md-357a23024ce02e3214400df28e711d38-eb3d52877fdfe1a2f69df58f6904904b.png">  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="-5"></a><a class="hash-link" href="#-5" title="Direct link to heading">#</a></h2><p>ysoserial.jar在生成CB链183版本的时候是用的192版本的BeanComparator，在构造时将serialVersionUID修改为183版本的。所以靶场中是不存在183版本BeanComparator类的，导致CB183链子失败。而同一个类名不能在默认的class loader中加载多次，所以没法添加183的依赖。解决方法是通过agent，根据不同payload加载不同的BeanComparator类，见下文。  </p><p><img src="/en/assets/images/wechat2md-34ed7ac6c5f977ba4460b4576281819e-7f35b02c740e05c5631dbcb36779cdba.png">  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="-6"></a><a class="hash-link" href="#-6" title="Direct link to heading">#</a></h2><p>Jdk7u21和jdk8u20的<strong>jre依赖版本不同</strong>。通过报错信息可以找到问题主要在sun.reflect.annotation.AnnotationInvocationHandler类的更新上，也就是这两条链需要不同版本的AnnotationInvocationHandler类，问题与上面类似。  </p><p><img src="/en/assets/images/wechat2md-b6e11d6d9c460e6a667593dabe694bad-46ca68de2733fbf0d9e9b4338c818a63.png">  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="-7"></a><a class="hash-link" href="#-7" title="Direct link to heading">#</a></h2><p>javaagent可以拦截类加载过程，可以在类加载时修改或直接替换类。所以可以使用agent实现对不同的gadget加载不同的class。  </p><p>Java agent的入口函数是premain，会被传入命令行参数和Instrumentation对象  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">public static void premain(String args,   Instrumentation instrumentation){</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ClassLoggerTransformer transformer   = new ClassLoggerTransformer(args);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      instrumentation.addTransformer(transformer);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>通过Instrumentation对象可以设置一些类加载的过程，例如案例中addTransformer，追加了一个ClassLoggerTransformer对象，ClassLoggerTransformer对象实现了transform方法，在加载一个类前会把类信息传给transform方法，返回值是经过处理后的类，用于替换原有类。  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">public byte[] transform(ClassLoader   loader,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                        String   className,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Class&lt;?&gt;   classBeingRedefined,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                          ProtectionDomain protectionDomain,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                        byte[] classfileBuffer) throws   IllegalClassFormatException {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return xxx                        </span></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>所以可以在transform中拦截类加载过程，将指定类替换为当前payload需要的版本。  </p><p><img src="/en/assets/images/wechat2md-372b0d5b222de3dd694f4c414cf77ae1-d35e5e5d42dbd6c87f41868584296791.png">  </p><header><h1></h1></header><p>被templateImpl加载的类需要继承AbstractTranslet接口，实现transform方法。为了解决这个限制，我让templateImpl加载一个类前先加载一个loader（实现了AbstractTranslet接口），再让loader加载目标类。但这个loader就是压倒header的最后一根稻草，导致gadget过大。执行流程如下：  </p><p><img src="/en/assets/images/wechat2md-9b8129aadef4d0d1acbcff926b822fd0-b3383ae6c061af59ad2d582814d56ea1.png">  </p><p>为了去掉实现AbstractTranslet接口的限制，又不影响payload大小，可以尝试直接改类的属性，修改class文件，给class增加一个父接口而不实现接口。  </p><p>测试时发现报错，原因是默认构造函数必须调用supper()或this()方法，之前测试类aa没有显示声明父类，默认父类是java.lang.Object。也就是还需要将java.lang.Object.init 方法的调用改为com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet.init 调用  </p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbUAAAC4CAMAAABTnYKFAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACylBMVEX////Zs7PZsrLfwMDSpaWNHBuLFxexZGOAAQH48PDgwcGBBQX8+Pjo0dH16uqbOTiDCQr9+vrKlpaQISH+/PykSEmZNDSWLi7HkJD9/Py2bW2wYmLq1tazZ2eUKirRo6L69fXz5+fs2dnYsbF/AAD37+/58vLkycnLl5eQIiL79/fTpqaiRUW2bm7w4eHChobt29vWrq6GEA/VrKy1bGzx5OTdu7uDBwfx4+ORJSXRoqKcOjqzaGiKFxWJFBS3cHD+/v7jx8fo0NCgQUHDh4efQECFDQuvYGD9+/v27u6jR0eqVlW5c3O8eXmXMTDEioqpVFS1a2vFi4u9e3u4cnKrV1fz6OihRET+/f3hxMTu3d3ly8v06enmzs748fH69vaPICD//v758/OjSEitW1uvX1/16+uGDg2kS0yJFhamTU2yZWXy5eXnz8+cOTmfQD+TJyfLmJjMmZm7d3eIExPWrK2iRkaoUlK6dXXUqqrixMTatLS/gIDOnZ3Jk5OAAgLfv7/GjY3ChYWHEBHYsLCOHyDMm5rEiYm8enrhw8ORIiTAgoL79vbNm5vKlZWBBAXQoaGLGRjr19enT0/BhITbuLirWFjixcWWLC2sWlrPoKCIERHdvLzlzMzu3t+qVVauXl6SJibIkZG3b2+CBgaZMjPSpKTXr6+VLCyaNzelTEy6dnbDiIitXFz27Oz8+fmECwvv4ODv39/mzc2aNjfkysrp1NTcubm/fX3IkpL59PT27e369PTgwsKMGxqyZma/fn7curqECgqdOzvx4uKmTk7s2tqNGxvNnJzFjIyOHx7bt7fTp6fs2NiUKyzBg4Pevr7evb3z5uaYMTKxYmSePj7p09O4cXHatbXPn5+gQkLo0tKoVFPjyMjt3Nzq1dXGjo6tXV20aWmdPT2nUFD17OwAAADJlJSYMDC9fHzTqKjVq6vbtrbjxsZ8r9FQAAAAAWJLR0QAiAUdSAAAE/JJREFUeNrtnf9f1FW+x9+5omO4yjgEojm440dTMDC/ZIOCigpSiFKiLCKKwpKN7voFtS1zTNLMLNDVymx3M7+bhl61dC3dvFdFajTWvm3eu1/abe/eb//DfXzm83mfc+acz3xTYATezx86nsP59jkvmRnh1esAEARBEARBEATRlbivW7ss86PusXk8ed1Y7aOViesRvk9Pm83WK4K57o/vDfBjWx+LL/VNsPvLfg6bLZG1PmCz2WxJ0W862WZL6p8S2DZgoFVPXFeqPzgosoXMfs5U9UvW6wWcV6TnFj2DB4fv8xPXEG1oBHMN0x4CGD7C6ktpw/xFH1u6y8VbRz7scrkyot+0M3PUI6PHBLaNlU9xnLCuvI9Hx/uLx8ItZPZzZ6lfGhtcNTyvSM8tSiY4HI6J+rMMys6ZNBmmjBgMkOvohXWOy1gd26dOm56XPwOg4PG8Jwpn8m5FswBmDwCwF/dwPwkAT80pyZs6F+Bhh2MeAJQO/alWNnQozHeUAyxwVMDIWcY47IflwkHZizIreR0Wj1gSoFo6QFU138/P5tVU9Qw8xdzHn2brsv2a9fsdSzWH4xmAPM8ycczyn/9ixcrsVWz/rJ97tTEe9yWvt9BTu7SwlO8Hz4uVrcqarKy16wDg2exfrop/DnqPfx5gfRKrK6phu3v0Cxu8GwFezE7dZPPwbjPnQWXdSwCrN6/ZkjAGYJD2cvrmrQCvZFVvA4Apmp/ElJwNAIVTAUa+un379sm8H5avLX391foFvA59bNniXyJnQ8r8uga+n8wdqZu8+UKHnb9K2DWYrcv2a9aXZT2sZWXtBsh4wzugnI+aor351p63907G/bN+7rrUVfp43Je83qqlq/olvCOcW5uqBgBbddV+/RuA3xYDvPEuwL73eF1WDdvd+wEe3w/Qdz1AkqDaowfsZVo5wIr+AG/0BBh0EKDfZv0rh/TT2r7zsPbczp0AW49AaXY6wEhdxPt4PyyP7gI49r44vjzglc6padqERL6f5OMAScIpnvDu/8D40yFDNXO/WMdXPoAfT4/vz1XLgeKGcq2C7Z+9Qk4yxuO+5PWSNwGsf0o4t3ZRrfH59wuT9wC8dNJ+SvsXXpdVw3b9db5wD8DSwwBjBdUqtNPd9be1hGOTJp1ZCzDIA/DYpkp+WuY8Ls11Nn4xwMhBH3744TDeD8uEjwA2BYwPxHku93zdcL4fvb/4PnOg5HcQoJq5X1U1uJC8VlRtbFYfrYLtX3xfKzTX0fclr6fXxfNpH9WmH5n13oQ9AB/Xf9LPKdRl1bAdn+Jid4BqQTVI7u8Zqz9F/vnz57sBDLqEXwhUDYp+P6dE/zRivq9hPywTPgXIXCuOl1RLB1jfl+9H7y+e4vPb6vrZI1Ft4bTL/5proZq5f0U1c1/yenpdPJ92Ue3ftAcB8vXVrkyaOk2sQ7nxl/aqVgBCOz7FuyVgr/UI/VbP3nYYAK41ACQmhlCtKS57dwjVVgwHqB4ojg/8ftNVu76N76d5C8AS8dNIygs5zZ+FUu2Av3ghZ8VHwiimGu4f++F43Je8nt5+eJVwbsZ58bItVGus69/4kKav9nlt/U6xXmDb7D8v++hpPl8ja8en+Ey7kX3NI/T7qF5/W4N3j5aNc2/lp37Vd/Oaz5fGVeul5dn9n/x9Pl+GqtqTN84+mveFoNqw5qkBqk0b1f3idb7P1UU7W7T8gOdamPkrvi7ul+0jQzvs+wOAI7VUHMNUw/1jPxyP+5LXu+5cMD/7beHcjPPiZWtTrL9SHVqk9d1TBQBDbYtArPfKO2L8LR/j1DQfa9ef4ln968tWLZ/oEfoN1Rx+UebZak6kAUw0T/2y/7PjWV21CqPlqP5CanwaSeL9sCzYX9e8K4XXoeDkvoDPkJrmPr6Y7zPjmHZr9pfSk9n5urhftg+4maNVAUj/UNdVS9VVw/1jPxyP+5LXKyiu2Tugt3Bu5nnxsnUZV2v8YzVNase6vdS6nTH5q3NW/RpLIRQXvGdD7ytR+ghiDzJfmlS2FsH2j/uS10tJbJt9WDB3RLPt6bv6/k3eV7v31B2MGx5XeQejCJ3GlpYLdzfDFy1nE+9k3NcPxvrZCYIgCIIgCIIgCCLm3K3HqZN4pGJKxB4p5mmSPU+BOG31Z1Itx4E4vu28S12CiD1S7He/sucpEHem6zXvZ1bjQBzfRt6lroL5W8leziaAb+ZVMq8ReqxGXl+bd6KRe5XQ84ReJfQ+IfpvNGb3VD1O6F3C8fh7too5cTuKK1QPFhEK9EhtyCvI1T7hXiP0WDnrtmw48C33KqHnCb1K6H1CdNWeWgeKxwm9SzgeVcu8uKbbokzVg0WEAj1SicmXzpwQvEboUXIWG987/JXO+A0+epW498kAVZM9TtzzFehE6DkbYPtCUDxYRCjQIwW5Ws0FwWuEHiXnHwGOf6eqhl4l7scwQNVkjxP3fAWq1qKd2Zob3ZYJ5raB06ZqptcIPUq6ai9bqWZ6laxUm7kOFI8T93xJrp+rc5zaI7E+hY4GqmZf4TlYwr1GzKPkPAdw6QnuVcJTR6+SlWp9C0H2OAmeL1M107s0uRJg4BVQPFhEKNAjtau24rZtN/MaMY+Ss8fyh/Z+zr1K6HFCr5KiWubOm1oLyB4n5l1iHinTu/Tvx5admj5I9WARoTA9UmXeMQCFO7YzrxF6lJwDFtXnLwbmVUKPE3qVmFfLxK15kw4JHi0ch94l7pEyvEtXf+GNfyZD9WAR0YFeI8Oj5PxjMNNRYpiXtMZw3i5sN81G9tCeLiIK9E8jREdjyh9ivQOCIAiCIAiCIAiC6PyQ1+reYcjSMB0i9GoR7cmQnDAdIvRqEe0JqoYeLCkfKrxXi7xWMQBVQw+WlA8V3qtFXqsYgKqxvCg5HyqsV4u8Vu0PqibmRYHosYrQq0W0J0w1IS8KRI9VhF4toj1B1dCDpeRDhfVqkdeq/Rky2ufTvVPowVLyocJ5tchrFQO6+T1UPubBUvOhwni1yGsVU9CDFS4fKtK8K4IgCIIgCIIgCIIgiK5N7wqAufTjrnuCSO8SrMys2w2wa9uaIPPMCBOp3tqesK7tMYv0LsHjm/9D/7/nHxn/jtWdiBnfebXk2wCVTePrI1snkFur7mrfXSnXK5q7BP/k/bPxh+41dvVOxLRFhRm9/pIzGPZkF3utFwvtCStaGe3mA+brZLlemH+l3H0Y7V2CDU6cUbst3Ilo0rJN/83BxYfg/YqNhmqS10tah93JiB4xXbUG5zCW/4X5XGYOGGtHzxnOp9xN2CnA/Cvl7sNo7xIc8Fcc6UgV7kQ0eW0dnE2at0+/JcpUTfJ6SeuwOxnRI1a0EspPDuf5X5jPZeaAsXb0nOF8yt2EnQL0Zsl3H0Z9l2DP73Fo8mvCnYgm/arg2LPzNUE1xesVuA7eyYgesaKV8MzRUp7fhflcmAOG7eg5w/mUuwk7BejNku8+jPouQUk1vBORq1a3HI6IqskEroN3MqJHrOjob7WrQv4X5nNhDhi2J3wUOJ9yN2GnAL1Z8t2HUd8l+PATOHTHIeB3InLVav4MRZGrhncyokes6G/52mkh/wvzuTAHDNvRc4bzKXcTdgbQm6XefRjtXYLvbTOn/J3mf3s070TkqiUPmZEgqiZ7vaR1jDsZmUesaCX8/a1Ent+F+VyYA4btmBNmzqfeTdgZQG+WevdhtHcJLtfMQMG3L/uvzTPvRDRpWgIvJjSf3A2nfP28Pl+p4vWS1zHvZGQesaKV8JOE13l+F+ZzYQ4YtmNOmDmfejdhpwC9Werdh9HeJfjAijK9ePPkTX/VvBPRZH79Ylj2ww92aPaPr1C8XvI6eCcjesQOrgQ4f/kDlt+F+VyYA4bt6DnD+dS7CTsH8l2Cd+rB2v6Adj/AX7RvrH4SmZb9rPy2Euk6skcM87uMfC6eA4btKdJ1ce1wN2GHZnkZwK+XWX+t7KL3b+PaYE3KAWtTKk+1tMXfesoBIwiCIAiCuFf5xz9ivQMieki1jgip1hEh1WKL02br4Yn6hxSkWmxx3/zTozeqoh1FqsUW/TchLyRUMk8TepjQ82Sdm0WqxRZdNc8E7mlCDxN6nqxzs0i12OL+alJfrYl7mtDDhJ4n69wsUi22uJPWaf8peJ3Qw4SeJ+vcLFIttriz4J8ewevEPEym58k6N4tUiy3uLPi8/gfmaWIeJvQ8WedmkWqxxZ0FjXU3maeJeZjQ82Sdm0WqxRZdjXN1jczThB4m9DxZ52aRavcKzOtk1vFOQqvcLFKtI0KqdURItY4IqUYQBEEQBEEQhMzQjNbtR7QC93UL0+HKXyObyOhnl/8vxbDzB9IF87c+tflZFkHXG7PMP8T1CN3xA9v9EeVW6f3gQnHNxXOJAM5U1m49P8vtYvswifBORiX3Kxih5zP3Gfz5gq4j7ztcewg+drmOTnS5ZkTQdR/OPnhw6I7Ds0sjyq3S+8H6Wx++Wfet8TuGkPOzfJN90lNGeCcjz0cJQ+j5zH0Gf76g6+ybFV17aB7Q/+/3+Y5ygAWOCiWXinPwdf2/ExwOx0Tu7WJ5V0IO11v/BTzfA9vR81XweN4ThTN5v7gGgO+rANznRubl2/n8Ui4Wy+3CfSCYl4UeMwTXMz1nwnhTG8mbhiXOh/vEebA/7hOfTzontg563eTzU3PLAp8nKtVScjYAFE5Vc6k4z/y3/t81WVlr1/F8KpZ3xXO4dmouQTVsR8/Xi9mpm2we3m/pSwBPrQNw7216L/5TPr+Ui8Vyu3AfCOZloceMfU+Y65meM2G8gexNwxLnw33iPOw5zH3i80nnxNZBr5t8fmpuWeDzRKUabD0Cpdnpai6VBVvXCflUmHfFc7hm/hME1bAdPV991wMkeXg/ptp+gCvf8/mVXKygrzxGugx6zJhq5nroOZPHy940Pt6YD/eJ84jP4d+n+XzKOZnrsHUlguWW3ZlqLs11Nn6xmksVTDX0dmHeFcurSszZIqqG7ehoWHoYYKyH92OqZRneMJxfycUKoxp6zJhq5nroOZPHy940Pt6YD/eJ84jP4Z/PfD7lnMx12LoSwXLL7kw1KPr9nBJQc6mCqYbeLsy7Yl6vL7wFomrYjk9/sTtAtYf3E1XLFFWTc7HCqIYeM0U103Mmj5e9aXy8MR/uE+cRnyNTVE0+J1TtU/Y8luvKuWV3qFpTXLb+si/nUgVRjedTGXlXvF71d6OXkVvF2vHp3y0Be62H97vVH6BEf+V5FeDLPVw1JReL3cForRp6zGTV0HMmjVe8aXy8MR/u05yHPwfu08zlUs7JXIetG4hFbtldqdZLy9M/Gsm5VEFU4/lURt4Vqw+L/9boZeRWsXY8xc+0G9nXPLzfhhWn37n8UwB3XO6U0f/DVZNzsTC3Swbzt9BjJquGnjNpvOJNwxLnw32a8/DnwH2auVzKOZnrsHUDUXPL7pCndxnlUX8woJxLZUFxiZC/hXlXWM+qwX+jGrlV2M48X8tWLZ/o4f2Gfp+341wpgHtic3zPj/n8ci4W5nbJYF4WesxE1fT10HMmj5e9aViynDBznzgPew62T+P51HMy1uHrBqLklt0dF7xnwTKXSmZcrfFBV5bUqE/YD5btApO/Oif2Y3lavQPnD5aLFYy0IIF0iUGur5W9acp4/z4tnqN3YLdg5xR23cgeKzTD4/yrhMmlmjui2fZ0iLy+0vRwPxxL3le791TQfuHmbz+Mfd7rfP2gvwiTS9XY0nLh7tb5ouVsiG+eu5+/tQi9T4IgCIIgCIIgCIIgOijJNltSf/GnmhF4lwYMDNuFaFOcmaMeGS36QSLwLo0l1WKMMx2gqpp5spinSL4rED1GP5tXU9VzoOBFku4oJNoDZ0PK/LoG5sliniL5rkD0GGXuSN3kzRe8SNIdhUR74NQ0bUIi92ThK6TsiUKPUfJxgKR80YtUHplrlGhFnOdyz9cN554s5k6RPFHoMdJL/X0thGeLaHP097X1fbkni6kmeaLQY6SXftWCe7aINkdX7fo27slCT5HsiUKPUfMWgCUDRS9S5V3ugIge57RR3S9e554s9BTJnij0GK0u2tmi5QueLemOQqI9cGqa+7j+fmZ6stBTJHui0GOUcUy7NftLwbMl3VFItCumJ4sje6LQY5Qmff1O70IkWgHTk0V0KExPFkEQBEEQBEEQBEEQrUea3boebSljj/BnL5HOR3Dm/lyzlTSq9WhLmcd6Xl60S/iJpZk/lVgv5XYFm6+yaXy9OB/mbMntXZMB35Ut2Jyu1qMtZd64MuqV0f/L62b+1Awt1eXadGBh2PX2ZBd7xfkwZ0tu75KUjt8I8OR06OVsAvhmXiXWoy1l71bKN78BGHhCyZ8q3bUM4Fi1sr4y3/sVGwNVM/Or5PYuyQztdu/ShoMAG/IKcrVPWD3a0sq7VfnWdYv8KYBy7TllfXU+kFRj40k1/ZRuXNJPKTH50pkTvB5taeXdajo51yJ/CuB63GRlfYv5JNXYeFJNP6VZ3fynlKvVXOD1aEsLvj6QDhb5U1ApRsuFmG+j8r5mjCfV9FMC8J/SaVTNX4+2VOmz4xKARf4U/J/2mLq+xXyqapmkmkHltTEAq5cA2Fd4DpbwerSl4t3qfXBqSkCOFsvJqp5usb7FfJJqbDypBrD+zIPPLX0ZYFdtxW3bbl6PtpS9W9UJr/h8ZRb5U8Pif2m1vlye8vXz+nz8H3w4Xm7vmvQpzjtQbYcy7xiAwh3bsR51KXu33Hoc1TWL/KmGy9st1lfKZn+eFY/ExfFye1fFnmJdj7oM8g0QLH8q3HoKQcYTBEEQBEEQBEEQBEEQBBEz/h9RFkDTfkDYNgAAAABJRU5ErkJggg==">  </p><p>最终成功实例化测试类，得到dnslog回显，反编译后的源码如图  </p><p><img src="/en/assets/images/wechat2md-90ab8bd12486daa406cde2c598656f3f-06ac4c88ca8c5aa956c609c8b47df60b.png">  </p><p><img src="/en/assets/images/wechat2md-dba49271ce3ba112432e5f27f19fc93e-5b129b0980611a1bcad17da50376d06c.png">  </p><header><h1></h1></header><p>本文通过 Java Agent 拦截和修改类加载机制，构建了一个 Java 靶场，用于验证和测试各种反序列化 payload。然而，对于更复杂的 Web 环境中的回显测试，仍然需要搭建实际环境进行验证。  </p><p>文章最后介绍了一个手动修改 class 文件以添加父类的案例，展示了如何在继承抽象类时不实现其所有抽象方法。这证明了 &quot;在继承抽象类时必须实现所有抽象方法&quot; 的规定是在编译期间检测的，而 JVM 在运行时并未对此进行验证（至少在 HotSpot VM 中没有验证）。  </p><p><strong>END</strong><br>
<strong>YAK官方资源</strong><br>
Yak 语言官方教程：<br>
<a href="https://yaklang.com/docs/intro/Yakit" target="_blank" rel="noopener noreferrer">https://yaklang.com/docs/intro/Yakit</a><br>
视频教程：<br>
<a href="https://space.bilibili.com/437503777Github" target="_blank" rel="noopener noreferrer">https://space.bilibili.com/437503777Github</a><br>
下载地址：<br>
<a href="https://github.com/yaklang/yakitYakit" target="_blank" rel="noopener noreferrer">https://github.com/yaklang/yakitYakit</a><br>
官网下载地址：<br>
<a href="https://yaklang.com/Yakit" target="_blank" rel="noopener noreferrer">https://yaklang.com/Yakit</a><br>
安装文档：<br>
<a href="https://yaklang.com/products/download_and_install" target="_blank" rel="noopener noreferrer">https://yaklang.com/products/download_and_install</a><br>
Yakit使用文档：<br>
<a href="https://yaklang.com/products/intro/" target="_blank" rel="noopener noreferrer">https://yaklang.com/products/intro/</a><br>
常见问题速查：<br>
<a href="https://yaklang.com/products/FAQ" target="_blank" rel="noopener noreferrer">https://yaklang.com/products/FAQ</a>  </p><p><img src="/en/assets/images/wechat2md-8764ec1e71cc199b4b0b0bfb3a12e542-c338b399163d221eff4331d7447705d9.other">  </p><p><img src="/en/assets/images/wechat2md-304b45488320344b4c7cdbd5759ee4e8-dd613fed6f1f91dbad38e23417bb4c9e.gif"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/en/articles/yaklang-commandline-use"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Yak 命令行扫描指南</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="div--flex footer__bottom text--center"><div class="footer-logo-copyright-navigation"><div class="margin-bottom--sm"><a class="footer-link" href="/en/"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright copyright-style"><a class="footer-a" href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">Copyright © 2025 for Yak Project. 京ICP备17047700号-3</a></div><div class="link-body"><a class="footer__link-item" href="/docs/intro" target="_blank">官方文档</a><a class="footer__link-item" href="/en/team">关于我们</a></div></div><div class="footer-contact-me"><a href="https://github.com/yaklang/yakit" target="_blank" class="contact-icon-body"><span role="img" aria-label="github" class="anticon anticon-github icon-style github-icon"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></span></a><div class="contact-icon-body"><span role="img" aria-label="wechat" class="anticon anticon-wechat icon-style wechat-icon"><svg viewBox="64 64 896 896" focusable="false" data-icon="wechat" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M690.1 377.4c5.9 0 11.8.2 17.6.5-24.4-128.7-158.3-227.1-319.9-227.1C209 150.8 64 271.4 64 420.2c0 81.1 43.6 154.2 111.9 203.6a21.5 21.5 0 019.1 17.6c0 2.4-.5 4.6-1.1 6.9-5.5 20.3-14.2 52.8-14.6 54.3-.7 2.6-1.7 5.2-1.7 7.9 0 5.9 4.8 10.8 10.8 10.8 2.3 0 4.2-.9 6.2-2l70.9-40.9c5.3-3.1 11-5 17.2-5 3.2 0 6.4.5 9.5 1.4 33.1 9.5 68.8 14.8 105.7 14.8 6 0 11.9-.1 17.8-.4-7.1-21-10.9-43.1-10.9-66 0-135.8 132.2-245.8 295.3-245.8zm-194.3-86.5c23.8 0 43.2 19.3 43.2 43.1s-19.3 43.1-43.2 43.1c-23.8 0-43.2-19.3-43.2-43.1s19.4-43.1 43.2-43.1zm-215.9 86.2c-23.8 0-43.2-19.3-43.2-43.1s19.3-43.1 43.2-43.1 43.2 19.3 43.2 43.1-19.4 43.1-43.2 43.1zm586.8 415.6c56.9-41.2 93.2-102 93.2-169.7 0-124-120.8-224.5-269.9-224.5-149 0-269.9 100.5-269.9 224.5S540.9 847.5 690 847.5c30.8 0 60.6-4.4 88.1-12.3 2.6-.8 5.2-1.2 7.9-1.2 5.2 0 9.9 1.6 14.3 4.1l59.1 34c1.7 1 3.3 1.7 5.2 1.7a9 9 0 006.4-2.6 9 9 0 002.6-6.4c0-2.2-.9-4.4-1.4-6.6-.3-1.2-7.6-28.3-12.2-45.3-.5-1.9-.9-3.8-.9-5.7.1-5.9 3.1-11.2 7.6-14.5zM600.2 587.2c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9c0 19.8-16.2 35.9-36 35.9zm179.9 0c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9a36.08 36.08 0 01-36 35.9z"></path></svg></span></div></div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.e478f0b7.js"></script>
<script src="/en/assets/js/main.12a33ab3.js"></script>
</body>
</html>